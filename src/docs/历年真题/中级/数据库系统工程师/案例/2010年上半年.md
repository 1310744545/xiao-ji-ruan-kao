---  
title: 2010年上半年  
# icon: gears  
order: 999  
category:  
- 历年真题  
tag:  
- 真题  
  
# navbar: false  
# sidebar: false  
  
# breadcrumb: false  
# pageInfo: false  
# contributors: false  
# editLink: false  
# lastUpdated: false  
# prev: false  
# next: false  
comment: false  
# footer: false  
  
# backtotop: false  
---  
## 第1题 ##

试题一（15分）  
阅读下列说明，回答问题1至问题4，将解答填入答题纸的对应栏内。  
【说明】  
某大型企业的数据中心为了集中管理、控制用户对数据的访问并支持大量的连接需求，欲构建数据管理中间件，其主要功能如下：  
(1)数据管理员可通过中间件进行用户管理、操作管理和权限管理。用户管理维护用户信息，用户信息（用户名、密码）存储在用户表中；操作管理维护数据实体的标准 操作及其所属的后端数据库信息，标准操作和后端数据库信息存放在操作表中；权限管理维护权限表，该表存储用户可执行的操作信息。  
(2)中间件验证前端应用提供的用户信息。若验证不通过，返回非法用户信息；若验证通过，中间件将等待前端应用提交操作请求。  
(3)前端应用提交操作请求后，中间件先对请求进行格式检查。如果格式不正确，返回格式错误信息；如果格式正确，则进行权限验证（验证用户是否有权执行请求的操 作），若用户无权执行该操作，则返回权限不足信息，否则进行连接管理。  
(4)连接管理连接相应的后台数据库并提交操作。连接管理先检查是否存在空闲的数据库连接，如果不存在，新建连接；如果存在，则重用连接。  
(5)后端数据库执行操作并将结果传给中间件，中间件对收到的操作结果进行处理后，将其返回给前端应用。  
现采用结构化方法对系统进行分析与设计，获得如图1-1所示的顶层数据流图和图1-2所示的0层数据流图。  
![55652bee2ec348608482b423a8ca23e4.jpg][]  
![1ed822a52d98468a8e8f4bc138f00e57.jpg][]  
  
【问题1】（3分）  
使用说明中的词语，给出图1-1中的实体E1~E3的名称。  
  
【问题2】（3分）  
使用说明中的词语，给出图1-2中的数据存储D1~D3的名称。  
  
【问题3】（6分）  
给出图1-2中加工P的名称及其输入、输出流。  
![1ce48c64b8644af1b4e0566fbaf2f7f9.jpg][]  
除加工P的输入与输出流外，图1-2还缺失了两条数据流，请给出这两条数据流的起点和终点。  
![9dd090f4807849f3a7deab2edc137c99.jpg][]  
注：名称使用说明中的词汇，起点和终点均使用图1-2中的符号或词汇。  
  
【问题4】（3分）  
在绘制数据流图时，需要注意加工的绘制。请给出三种在绘制加工的输入、输出时可能出现的错误。  


## 第2题 ##

试题二（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
天津市某银行信息系统的数据库部分关系模式如下所示：  
客户（客户号，姓名，性别，地址，邮编，电话）  
账户（账户号，客户号，开户支行号，余额）  
支行（支行号，支行名称，城市，资产总额）  
交易（交易号，账户号，业务金额，交易曰期）  
其中，业务金额为正值表示客户向账户存款；为负值表示取款。  
  
【问题1】（3分）  
以下是创建账户关系的SQL语句，账户号唯一识别一个账户，客户号为客户关系的唯一标识，且不能为空。账户余额不能小于1.00元。请将空缺部分补充完整。  
![7596fb0d4df1484993beea20d291e356.jpg][]  
  
【问题2】（7分）  
(1)现银行决策者希望查看在天津市各支行开户且2009年9月使用了银行存取服务的所有客户的详细信息，请补充完整相应的查询语句。  
![fbc7c3cbcc044f59b3cef3d1dc4ee3b1.jpg][]  
(2)假定一名客户可以申请多个账户，给出在该银行当前所有账户余额之和超过百万的客户信息并按客户号降序排列。  
![f60d6e098dd045b8970588c9169d0be5.jpg][]  
  
【问题3】（5分）  
(1)为账户关系增加一个属性“账户标记”，缺省值为0,取值类型为整数；并将当前账户关系中所有记录的“账户标记”属性值修改为0。请补充相关SQL语句。  
![5fe09df2701d4325b1ad0e50ca05c8d0.jpg][]  
(2)对于每笔金额超过10万元的交易，其对应账户标记属性值加1，给出触发器实现的方案。  
![c8b0acd5cf904c7eb1472296f5fb5b0d.jpg][]  


## 第3题 ##

试题三（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
某学校拟开发一套实验管理系统，对各课程的实验安排进行管理。  
【需求分析】  
每个实验室可进行的实验类型不同。由于实验室和实验员资源有限，需根据学生人数分批次安排实验室和实验员。一门含实验的课程可以开设给多个班级，每个班级每学期可以开设多门含实验的课程。每个实验室都有其可开设的实验类型。一门课程的一种实验可以根据人数、实验室的可容纳人数和实验室类型，分批次开设在多个实验室的不同时间段。一个实验室的一次实验可以分配多个实验员负责辅导实验，实验员给出学生的每次实验成绩。  
1.课程信息包括：课程编号、课程名称、实验学时、授课学期和开课的班级等信息；实验信息记录该课程的实验进度信息，包括：实验名、实验类型、学时、安排周次等信息，如表3-1所示。  
![9d78a51755234226974cb9c08b2d2c33.jpg][]  
2.以课程为单位制定实验安排计划信息，•包括：实验地点，实验时间、实验员等信息。实验计划如表3-2所示。  
![a26caa1c1c1c483197c499ae7656947d.jpg][]  
3.由实验员给出每个学生每次实验的成绩，包括：实验名，学号，姓名，班级，实验成绩等信息。实验成绩如表3-3所示。  
![334d2d6be4944e1d94968c524f1df896.jpg][]  
4.学生的实验课程总成绩根据每次实验的成绩以及每次实验的难度来计算。  
【概念模型设计】  
根据需求阶段收集的信息，设计的实体联系图（不完整）如图3-1所示。  
![5dc9b47b678e47ae8d4af006c16033b9.jpg][]  
【逻辑结构设计】  
根据概念模型设计阶段完成的实体联系图,得出如下关系模式（不完整):  
![d244c3f52e7c4a1c8941366623f88403.jpg][]  
  
【问题1】（6分）  
补充图3-1中的联系和联系的类型。  
  
【问题2】（6分）  
根据图3-1，将逻辑结构设计阶段生成的关系模式中的空（1）~（6）补充完整。对所有关系模式，用下划线标出各关系模式的主键。  
  
【问题3】（3分）  
如果需要记录课程的授课教师，新增加“授课教师”实体。请对图3-1进行修改，画出修改后的实体间联系和联系的类型。  


## 第4题 ##

试题四（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
某旅行社拟开发一套旅游管理系统，以便管理旅游相关的信息。  
1.旅行社可发布旅游线路的信息，包含：线路的价格、天数、住宿情况，以及具体的行程安排等。不同的线路参观的景点及住宿情况不相同，如表4-1所示。  
![3c9d9c2f53e344f18a2c8afa6e2b6052.jpg][]  
2.游客与旅行社沟通，选择适合自己的线路，并由旅行社为其生成订单，以记录游客联系人的姓名、身份证号、联系方式、人数、所选线路、导游安排和票务信息。旅行为游客在行程中的每个城市安排一个负责导游，负责游客在该城市的具体旅行安排。同一城市的负责导游相同，不同城市的负责导游有可能不同。  
3.旅行社的每位员工只属于一种固定的员工类别，系统可记录员工的多部手机号。旅行社按月统计导游每月的带团人数和游客投诉次数，以计算导游的当月月薪。  
根据上述需求，初步设计了旅游信息数据库，其关系模式如图4-1所示。  
![5ce1ac66931c4f0f91be871ee68ec5ea.jpg][]  
![972acbc4548e4889b65efe81799c6363.jpg][]  
  
【问题1】（3分）  
对关系“线路信息”，请回答以下问题：  
(1)列举出所有不属于任何候选键的属性（非键属性）。.  
(2)关系“线路信息”是否为BCNF范式，用60字以内文字简要叙述理由。  
  
【问题2】（7分）  
对关系“订单信息，’，请回答以下问题：  
(1) “订单信息”是否为2NF范式，用100字以内文字简要说明会产生什么问题。  
(2)把“订单信息”分解为第三范式，分解后的关系名依次为：订单信息1，订单信息2，…。  
(3)列出分解后的各关系模式的主键。  
  
【问题3】（5分）  
对关系“员工信息”，请回答以下问题：  
(1)关系“员工信息”是不是第四范式，用100字以内文字叙述理由。  
(2)若“员工信息”不是第四范式，将其分解为第四范式，分解后的关系名依次为:员工信息1，员工信息2,…。  


## 第5题 ##

试题五（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
某航空售票系统负责所有本地起飞航班的机票销售，并设有多个机票销售网点。各售票网点使用相同的售票程序。假设售票程序中用到的伪指令如表5-1所示。  
![45b4afa4f90848d380d56a566b17b606.jpg][]  
假设某售票网点一次售出a张航班A的机票，则售票程序的伪指令序列为：R (A, x);W(A，x-a)。根据上述业务及规则，完成下列问题：  
  
【问题1】（5分）  
若两个售票网点同时销售航班A的机票，在数据库服务器端可能出现如下的调度：  
A：R1(A,x),R2(A,x),W1(A,x-1), W2(A,x-2)；  
B：R1(A,x),R2(A, x),W2(A,x-2), W1(A,x-1)；  
C：R1(A,x),W1(A,x-1), R2(A,x), W2(A,x-2);  
其中Ri(A,x),Wi(A, x)分别表示第i个销售网点的读写操作，其余类同。  
假设当前航班A剩余10张机票，分析上述三个调度各自执拧完后的剩余票数，并指出错误的调度及产生错误的原因。  
  
【问题2】（6分）  
(1)判定事务并发执行正确性的准则是什么？如何保证并发事务正确地执行？  
(2)引入相应的加解锁指令，重写售票程序的伪指令序列，以保证正确的并发调度。  
  
【问题3】（4分）  
下面是用E-SQL实现的机票销售程序的一部分，请补全空缺处的代码。  
![c48215f84cf84bf28aa4e168148d3bea.jpg][]  



[55652bee2ec348608482b423a8ca23e4.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第1题/55652bee2ec348608482b423a8ca23e4.jpg
[1ed822a52d98468a8e8f4bc138f00e57.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第1题/1ed822a52d98468a8e8f4bc138f00e57.jpg
[1ce48c64b8644af1b4e0566fbaf2f7f9.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第1题/1ce48c64b8644af1b4e0566fbaf2f7f9.jpg
[9dd090f4807849f3a7deab2edc137c99.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第1题/9dd090f4807849f3a7deab2edc137c99.jpg
[7596fb0d4df1484993beea20d291e356.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第2题/7596fb0d4df1484993beea20d291e356.jpg
[fbc7c3cbcc044f59b3cef3d1dc4ee3b1.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第2题/fbc7c3cbcc044f59b3cef3d1dc4ee3b1.jpg
[f60d6e098dd045b8970588c9169d0be5.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第2题/f60d6e098dd045b8970588c9169d0be5.jpg
[5fe09df2701d4325b1ad0e50ca05c8d0.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第2题/5fe09df2701d4325b1ad0e50ca05c8d0.jpg
[c8b0acd5cf904c7eb1472296f5fb5b0d.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第2题/c8b0acd5cf904c7eb1472296f5fb5b0d.jpg
[9d78a51755234226974cb9c08b2d2c33.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第3题/9d78a51755234226974cb9c08b2d2c33.jpg
[a26caa1c1c1c483197c499ae7656947d.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第3题/a26caa1c1c1c483197c499ae7656947d.jpg
[334d2d6be4944e1d94968c524f1df896.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第3题/334d2d6be4944e1d94968c524f1df896.jpg
[5dc9b47b678e47ae8d4af006c16033b9.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第3题/5dc9b47b678e47ae8d4af006c16033b9.jpg
[d244c3f52e7c4a1c8941366623f88403.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第3题/d244c3f52e7c4a1c8941366623f88403.jpg
[3c9d9c2f53e344f18a2c8afa6e2b6052.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第4题/3c9d9c2f53e344f18a2c8afa6e2b6052.jpg
[5ce1ac66931c4f0f91be871ee68ec5ea.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第4题/5ce1ac66931c4f0f91be871ee68ec5ea.jpg
[972acbc4548e4889b65efe81799c6363.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第4题/972acbc4548e4889b65efe81799c6363.jpg
[45b4afa4f90848d380d56a566b17b606.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第5题/45b4afa4f90848d380d56a566b17b606.jpg
[c48215f84cf84bf28aa4e168148d3bea.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第5题/c48215f84cf84bf28aa4e168148d3bea.jpg
