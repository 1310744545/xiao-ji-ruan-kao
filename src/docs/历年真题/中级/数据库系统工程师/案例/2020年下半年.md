---  
title: 2020年下半年  
# icon: gears  
order: 989  
category:  
- 历年真题  
tag:  
- 真题  
  
# navbar: false  
# sidebar: false  
  
# breadcrumb: false  
# pageInfo: false  
# contributors: false  
# editLink: false  
# lastUpdated: false  
# prev: false  
# next: false  
comment: false  
# footer: false  
  
# backtotop: false  
---  
## 第1题 ##

试题一（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
某小区快递驿站代为收发各家快递公司的包裹，为规范包裹收发流程，提升效率，需要开发一个信息系统。请根据下述需求描述完成该系统的数据库设计。  
【需求描述】  
(1)记录快递公司和快递员的信息。快递公司信息包括公司名称、地址和一个电话；快递员信息包括姓名、手机号码和所属公司名称。一个快递公司可以有若干快递员，一个快递员只能属于一家快递公司。  
(2)记录客户信息，客户信息包括姓名、手机号码和客户等级。驿站对客户进行等级评定，等级高的客户在驿站投递包裹有相应的优惠。  
(3)记录包裹信息，便于快速查找和管理。包裹信息包括包裹编号、包裹到达驿站时间、客户手机号码和快递员手机号码。快递驿站每个月根据收发的包裹数量，与各快递公司结算代收发的费用。  
【概念模型设计】  
根据需求阶段收集的信息，设计的实体联系图（不完整）如图1-1所示。  
![79eb70f8d54b4a748dbeb304644b5a82.jpg][]  
【逻辑结构设计】  
根据概念模型设计阶段完成的实体联系图，得出如下关系模式（不完整）:  
快递公司（公司名称，地址,电话）  
快递员（姓名，怏递员手机号码，（a）)  
客户（姓名，客户手机号码，客户等级）  
包裹（编号，到达时间，(b)，快递员手机号码  
  
【问题1】（6分）  
根据问题描述，补充图1-1的实体联系图。  
  
【问题2】（4分）  
补充逻辑结构设计结果中的（a）、（b）两处空缺及完整性约束关系。  
  
【问题3】（5分）  
若快递驿站还兼有代缴水电费业务，请增加新的“水电费缴费记录”实体，并给出客户和水电费缴费记录之间的“缴纳”联系，对图1-1进行补充。“水电费缴费记录”实体包括编号、客户手机号码、缴费类型、金额和时间，请给出“水电费缴费记录”的关系模式，并说明其完整性约束。  


## 第2题 ##

试题二（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
某市居委会在新冠病毒疫情期间需分配社区人员到辖区内各个小区，协助小区物业人员 进行业主出入登记及体温检测工作。居委会为高效完成工作并记录必要的工作信息，设计了相应的数据库。其中有一个表用来记录工作人员在各个小区的分布情况及每天工作时长。表的结构如下：  
人员分配（人员编号，人员姓名，小区编号，物业经理姓名，人员职责)。  
其中人员编号和小区编号唯一，人员职责用于记录该人员需配合小区完成的工作，假设每个人员在同一个小区只负责一项工作，但在不同小区可以负责不同的工作。请回答以下问题。  
  
【问题1】（6分）  
给出人员分配表中成立且左侧只有一个属性的所有函数依赖关系。题中设计的人员分配表是否满足2NF，请用100字以内的文字说明原因。  
  
【问题2】（3分）  
如果要将人员分配表规范化为满足3NF，请用100字以内的文字简要说明解决方案。  
  
【问题3】（6分）  
请给出问题2设计结果中各个表的主键和外键。  


## 第3题 ##

试题三（15分）  
阅读下列说明，回答问题1至问题4，将解答填入答题纸的对应栏内。  
【说明】  
某订单管理系统的部分数据库关系模式如下：  
客户：CUSTOMERS（Cno, Cname, Cage, Csex），各属性分别表示客户编号、客户姓名、 年龄和性别；  
商品：GOODS（Gno, Gname, Gprice, Gorigin），各属性分别表不商品编号、商品名称、 单价和产地；  
订单：ORDERS（Ono. Cno, Gno, Oprice, Onumber），各属性分别表不订单编号、客户编号、商品编号、顾客购买商品的单价和数量。  
有关关系模式的说明如下：  
(1) 下画线标出的属性是表的主键。  
(2) 商品表中的Gprice是商品的当前价格，可能会发生变动；订单表中的Oprice是订单成交时的商品单价。  
(3) 一个订单只包含一位顾客购买的一种商品；其商品数量至少1件，最多99件。 根据以上描述，回答下列问题，将SQL语句的空缺部分补充完整。  
  
【问题1】（3分）  
请将下面创建订单表的SQL语句补充完整，要求定义实体完整性约束、参照完整性约束，以及其他完整性约束。  
CREATE TABLE ORDERS (  
Ono CHAR(20) PRIMARY KEY,  
Cno CHAR(10) (a),  
Gno CHAR(15) (b),  
Oprice NUMERIC(7,2),  
Onumber SMALLINT (c));  
  
【问题2】（5分）  
查询所有订单的详细情况，要求输出订单号（Ono)、客户姓名（Cname)、商品名称 (Gname)、单价（Oprice)、数量（Onumber)和金额（Oamount)，查询结果按照金额从大到小排列。此功能由下面的SQL语句实现，请补全。  
SELECT Ono, Cname, Gname, Oprice, Onumber, (d) AS Oamount  
FROM CUSTOMERS, ORDERS,  
GOODS WHERE (e)  
AND (f)  
(q) BY (h);  
  
【问题3】（5分）  
创建已售商品信息视图，给出已售商品的编号（Gno)、名称（Gname)、订单个数（Onum)及平均每单的商品数量（GAnum)。此视图的创建语句如下，请补全。  
CREATE (i) GOODS\_SOLD AS  
SELECT ORDERS.Gnc AS Gn〇, MIN(GOODS?Gname) AS Gname,  
(j) AS Onum, (k)\_ AS GAnum  
FROM ORDERS, GOODS  
WHERE ORDERS.Gno = GOODS.Gno  
(1) BY (m);  
  
【问题4】（2分）  
查询未售出商品的编号和名称。此功能由下面的SQL语句实现，请补全。  
SELECT Gno, Gname  
FROM (n)  
（o）  
SELECT Gno, Gname  
FROM GOODS\_SOLD;  


## 第4题 ##

试题四（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
某网上销售系统的部分关系模式如下：  
订单表：orders(o\_no,o\_date,o\_time,p\_no,m\_no,p\_price,nums,amt,status)。其中属性含义分别为：订单号、订单日期、订单时间、产品编码、供应商编码、产品价格、产品数量、 订单金额、订单状态（0-未处理、1-已处理、2-已取消）。  
产品表：products (p\_no, p\_name, p\_\_type, price, m\_no, p\_nums)。其中属性含义分另存为： 产品编码、产品名称、产品类型、产品价格、供应商编码、库存数量。  
  
【问题1】（5分）  
节假日时，由供应商提供商品打折后的新价格，数据存放在临时表中，该临时表的表名为tmp\_prices (不同供应商有不同的临时表)，其关系模式如下：  
tmp\_prices(p\_no, t\_price,m\_no);  
后台维护人员需要根据供应商填写在tmp\_prices中的数据来更新产品表中某些产品的价格。下面是基于游标，用SQL实现的价格更新程序，请补全空缺处的代码。  
CREATE PROCEDURE UpdatePrice()  
DECLARE  
Pno VARCHAR(10);  
Pprice real (6,2);  
Mno VARCHAR(10);  
(a) upPrice IS  
SELECT p\_no, t\_price, m\_no FROM tmp\_prices;  
BEGIN  
(b) upPrice;  
LOOP  
FETCH upPrice INTO (c);  
IF NOTFOUND DO BREAK //FETCH 操作无数据  
UPDATE products SET price = Pprice WHERE p\_no=Pno and m\_no=Mno;  
if error //error是由DBMS提供的上一句SQL的执行状态  
BEGIN  
ROLLBACK;  
RETURN -1;  
END  
END LOOP  
CLOSE upPrice;  
(d);  
END;  
  
【问题2】（6分）  
假设用户1和用户2同时购买1份A商品，用户3查询和浏览A商品。三个用户对应事务的部分调度序列如表4-1所示（事务中朱进行并发控制），其中T0时刻该A商品的库存数量 p\_nums为 100。  
![cf840522e2294f84ae57904450360331.jpg][]  
请说明T4、T7时刻，用户3事务读取到的p\_nums数值分别是多少。请说明T8时刻事务调度结果是否正确？若不正确请说明属于哪一种数据不一致性。  
  
【问题3】（4分）  
为保证并发事务的正确性，系统要求所有事务需遵循两段锁协议。  
(1)请用100字以内的文字简要解释两段锁协议，并说明“两段”的含义。  
(2)请说明两段锁协议是否可以避免死锁？如不能避免，应采取什么措施解决死锁问题。  


## 第5题 ##

试题五（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
如果一个数据库恢复系统采用检查点机制，且其日志文件如表5-1所示，第一列表示日志记录编号，第二列表示日志记录内容。 &lt;Ti,START&gt;表示事务Ti开始执行， &lt;Ti，COMMIT&gt;表示事务Ti提交， &lt;Ti，D，V1，V2&gt;表示事务Ti将数据项D的值由V1修改为V2。请回答以下问题。  
![005cdf2828074417992ea238c14271bc.jpg][]  
  
【问题1】（6分）  
假设系统开始执行前X=100，Y=50，Z=10，系统出错恢复后，X、Y、Z各自的数值是多少？  
  
【问题2】（4分）  
系统发生事务故障时，故障恢复有撤销事务（undo）和重做事务（redo）两个操作。请给出系统恢复时需要redo的事务列表和需要undo的事务列表。  
  
【问题3】（5分）  
请用100字以内的文字，简要描述系统出错后，基于检查点的恢复过程。  



[79eb70f8d54b4a748dbeb304644b5a82.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第1题/79eb70f8d54b4a748dbeb304644b5a82.jpg
[cf840522e2294f84ae57904450360331.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第4题/cf840522e2294f84ae57904450360331.jpg
[005cdf2828074417992ea238c14271bc.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第5题/005cdf2828074417992ea238c14271bc.jpg
