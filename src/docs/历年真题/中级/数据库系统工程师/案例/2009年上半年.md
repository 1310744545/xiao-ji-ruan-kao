---  
title: 2009年上半年  
# icon: gears  
order: 1000  
category:  
- 历年真题  
tag:  
- 真题  
  
# navbar: false  
# sidebar: false  
  
# breadcrumb: false  
# pageInfo: false  
# contributors: false  
# editLink: false  
# lastUpdated: false  
# prev: false  
# next: false  
comment: false  
# footer: false  
  
# backtotop: false  
---  
## 第1题 ##

试题一（15分）  
阅读下列说明，回答问题1至问题2，将解答填入答题纸的对应栏内。  
【说明】  
假设某大型商业企业由商品配送中心和连锁超市组成，其中商品配送中心包括采购、财务、配送等部门。为实现高效管理，设计了商品配送中心信息管理系统，其主要功能描述如下：  
1.系统接收由连锁超市提出的供货请求，并将其记录到供货请求记录文件。  
2.在接到供货请求后，从商品库存记录文件中进行商品库存信息査询。如果库存满足供货请求，则给配送处理发送配送通知；否则，向采购部门发出缺货通知。  
3.配送处理接到配送通知后，查询供货请求记录文件，更新商品库存记录文件，并向配送部门发送配送单，在配送货品的同时记录配送信息至商品配送记录文件。  
4.采购部门接到缺货通知后，与供货商洽谈，进行商品采购处理，合格商品入库，并记录采购清单至采购清单记录文件、向配送处理发出配送通知，同时通知财务部门给供货商支付货款。  
该系统采用结构化方法进行开发，得到待修改的数据流图（如图1-1所示)。  
![f13ddfc006674d1dbe6c524c0c4c4c7e.jpg][]  
  
【问题1】（8分）  
使用【说明】中的词语，给出图1-1中外部实体E1至E4的名称和数据存储D1至D4的名称。  
  
【问题2】（7分）  
图1-1中存在四处错误数据流，请指出各自的起点和终点：若将上述四条错误数据流删除，为保证数据流图的正确性，应补充三条数据流，请给出所补充数据流的起点和终点。（起点和终点请采用数据流图1-1中的符号或名称）  
![b996e663acfe43eebc500a32b63c88de.jpg][]  


## 第2题 ##

试题二（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
某网上书店后台数据库的部分关系模式如下：  
会员（会员编号，用户名，密码，姓名，地址，邮编，电话，消费额，积分）  
图书（图书编号，类型名称，图书名称，作者，出版社，出版日期，ISBN，价格）  
订单（订单编号，用户名，销售额，订购日期，出货曰期）  
订单明细（订单明细编号，订单编号，图书编号，数量）  
  
【问题1】（3分）  
下面是创建订单关系的SQL语句，订单编号唯一识别一个订单，用户名为订购图书的会员用户名，且不能为空。要求订购日期不能大于出货日期。请将空缺部分补充完整。  
![cc17c7e79dcb46b0b2ad894103b5a3d6.jpg][]  
  
【问题2】（10分）  
请完成下列查询的SQL语句。  
(1)查询名称中包含“数据库”的图书的图书名称，作者，出版社和出版日期。  
![054c3bf3c7d14ffcbae4ab046b13aa92.jpg][]  
(2)查询提供销售（图书表中有）但没有销售过（没在订单明细表中出现）的图书名称和出版社。  
![d766a23d11544836940dd07dbaab9be0.jpg][]  
(4)为了统计会员的购买行为信息，实施有意义的客户关怀策略，査询会员的平均订购间隔时间，考虑多次购买图书和一次购买图书的情况（其中，DATEDIFF函数表示两个日期之间的天数)。  
![0359a865d932457a9c27bf36c60c03a3.jpg][]  
  
【问题3】（2分）  
会员订购图书后，将本次订购的销售额累加到该会员的消费额中，并按照本次订单的销售额计算积分累加到该会员的积分中（每20元增加1个积分，不足20元不计入积分）。下面用触发器实现该需求，请填充空缺部分。  
![c720c0314cb54b579343b0ce9671620d.jpg][]  


## 第3题 ##

试题三（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
某集团公司拥有多个大型连锁商场，公司需要构建一个数据库系统便于管理其业务运作活动。  
【需求分析结果】  
1.商场需要记录的信息包括商场编号（商场编号不重复)、商场名称、地址和联系电话。某商场信息如下表1所示。  
![bb559a5e03eb4448b8d51e8dce84b089.jpg][]  
2.每个商场包含不同的部门，部门需要记录的信息包括部门编号（不同商场的部门编号不同)、部门名称、位置分布和联系电话。某商场的部门信息如表2所示。  
![387bca0687804be2bb4dc34980c708e6.jpg][]  
3.每个部门雇用了多名员工处理日常事务，每名员工只能属于一个部门（新进员工在培训期不隶属于任何部门）。员工需要记录的信息包括员工编号、姓名、岗位、电话号 码和工资。员工信息如下表3所示。  
![8bc31cf9444b405e92ff88fa782f62c5.jpg][]  
4.每个部门的员工中有一个是经理，每个经理只能管理一个部门。系统要记录每个经理的任职时间。  
【概念模型设计】  
根据需求阶段收集的信息，设计的实体联系图和关系模式（不完整）如下：  
![89349d1ae61d4c67b0757a08e2b954cf.jpg][]  
  
【关系模式设计】  
![f502d6c938964c0295144f085a7e33a2.jpg][]  
  
【问题1】（7分）  
根据问题描述，补充四个联系，完善图3-1的实体联系图。  
  
【问题2】（6分）  
根据实体联系图，将关系模式中的空(a)~(c)补充完整，并分别给出部门、员工和经理关系模式的主键和外键。  
  
【问题3】（2分）  
为了使商场有紧急事务时能联系到轮休的员工，要求每位员工必须且只能登记一位紧急联系人的姓名和联系电话（假设不同员工可以登记相同的紧急联系人）。则在图3-1中还需添加的实体是(d),该实体与图3-1中的员工关系存在(e) 联系。给出该实体的关系模式。  


## 第4题 ##

试题四（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
M公司为某宾馆设计宾馆机票预订系统，初步的需求分析结果如下：  
(1)客户可以在提前预订或直接入住时向宾馆提供相关信息，宾馆登记的客户信息包括：客户编号，姓名，性别，类型，身份证号，联系方式，预订日期，入住时间和离开时间等信息。其中类型字段说明客户是普通客户或VIP客户，不同的客户类型享受订票的折扣额度不同。直接入住的客户其预订日期取空值。  
(2)需要预订机票的客户应填写“机票预订”表，提供飞行日期、航班号、出发时间、目的地等信息。宾馆根据客户订票信息购票后，生成“客户订单”表，并根据客户类型确定相应的折扣额度。“机票预订”和“客户订单”表如下表1、表2所示。  
![0eeddf8638934928800a958f670c2c68.jpg][]  
![1ecd87ae698d4fd1aa4e9e04c742b92d.jpg][]  
【逻辑结构设计】  
根据需求阶段收集的信息，设计的关系模式如下图所示。  
![2649fc809ae440c595cfe8ce186f97b9.jpg][]  
关系模式的主要属性、含义及约束如下表3所示。  
![058c250df71946d7ad0b5821883bbae7.jpg][]  
  
【问题1】（6分）  
对关系“客户”，请回答以下的问题：  
(1)若选定（客户编号，预订日期）作为主码，未预订而直接入住的客户信息能否录入客户表？如不能，请说明原因。  
(2)对“客户”关系增加一个流水号属性作为主码，“客户”关系属于第几范式？还存在哪些问题？  
(3)将增加入住标识属性后的“客户”关系分解为第三范式，分解后的关系名依次取客户1、客户2、…。  
  
【问题2】（6分）  
对关系“航班”，请回答以下问题：  
(1)列举出“航班”关系中所有不属于任何候选码的属性（非码属性）。  
(2)该关系模式可达到第几范式？用不超过60个字的内容叙述理由。  
  
【问题3】（3分）  
对于没有预订客房或入住宾馆的客户，需要在（a）关系中修改其（b）属性的值域，以满足这类客户在宾馆预订机票的需求。  


## 第5题 ##

试题五（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
某停车场有多个入口和出口，车辆进入时从入口处由系统查询可用的停车位，从出口驶出时系统将其刚使用的车位标记为空车位。  
假设实现停车场管理的伪指令如下表1所示：  
![feb7ac538fe64a7f842912dd5981a436.jpg][]  
根据上述描述，在入口处的伪代码程序为：  
![014ad60bf9f144b4af2d80eafd9aa1e6.jpg][]  
  
【问题1】（3分）  
若两辆车在不同的入口处同时执行上述代码，会出现什么问题？（100字以内描述）  
  
【问题2】（8分）  
为保证入口处伪代码正确地并发执行，引入共享锁指令XLock(T)对表T进行加锁：Upgrade(T)对表T所加的共享锁升级为独占锁；解锁指令Unlock(T)对表T进行解锁。  
(1)请修改上述入口处的伪代码程序，使其满足2PL协议。  
(2)满足2PL协议的入口处的伪代码程序，在并发执行时是否会产生死锁?若是，给出一个产生死锁的调度。  
  
【问题3】（4分）  
若停车位表的关系模式为：park(parkno, isused)，其中parkno为停车位号，isused为停车位标志，0为空，1为非空。  
![102699d20fb04b64bc813768c2d69071.jpg][]  



[f13ddfc006674d1dbe6c524c0c4c4c7e.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第1题/f13ddfc006674d1dbe6c524c0c4c4c7e.jpg
[b996e663acfe43eebc500a32b63c88de.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第1题/b996e663acfe43eebc500a32b63c88de.jpg
[cc17c7e79dcb46b0b2ad894103b5a3d6.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第2题/cc17c7e79dcb46b0b2ad894103b5a3d6.jpg
[054c3bf3c7d14ffcbae4ab046b13aa92.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第2题/054c3bf3c7d14ffcbae4ab046b13aa92.jpg
[d766a23d11544836940dd07dbaab9be0.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第2题/d766a23d11544836940dd07dbaab9be0.jpg
[0359a865d932457a9c27bf36c60c03a3.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第2题/0359a865d932457a9c27bf36c60c03a3.jpg
[c720c0314cb54b579343b0ce9671620d.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第2题/c720c0314cb54b579343b0ce9671620d.jpg
[bb559a5e03eb4448b8d51e8dce84b089.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第3题/bb559a5e03eb4448b8d51e8dce84b089.jpg
[387bca0687804be2bb4dc34980c708e6.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第3题/387bca0687804be2bb4dc34980c708e6.jpg
[8bc31cf9444b405e92ff88fa782f62c5.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第3题/8bc31cf9444b405e92ff88fa782f62c5.jpg
[89349d1ae61d4c67b0757a08e2b954cf.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第3题/89349d1ae61d4c67b0757a08e2b954cf.jpg
[f502d6c938964c0295144f085a7e33a2.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第3题/f502d6c938964c0295144f085a7e33a2.jpg
[0eeddf8638934928800a958f670c2c68.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第4题/0eeddf8638934928800a958f670c2c68.jpg
[1ecd87ae698d4fd1aa4e9e04c742b92d.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第4题/1ecd87ae698d4fd1aa4e9e04c742b92d.jpg
[2649fc809ae440c595cfe8ce186f97b9.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第4题/2649fc809ae440c595cfe8ce186f97b9.jpg
[058c250df71946d7ad0b5821883bbae7.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第4题/058c250df71946d7ad0b5821883bbae7.jpg
[feb7ac538fe64a7f842912dd5981a436.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第5题/feb7ac538fe64a7f842912dd5981a436.jpg
[014ad60bf9f144b4af2d80eafd9aa1e6.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第5题/014ad60bf9f144b4af2d80eafd9aa1e6.jpg
[102699d20fb04b64bc813768c2d69071.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第5题/102699d20fb04b64bc813768c2d69071.jpg
