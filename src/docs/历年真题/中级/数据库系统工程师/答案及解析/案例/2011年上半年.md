---  
title: 2011年上半年  
# icon: gears  
order: 998  
category:  
- 历年真题  
tag:  
- 真题  
  
# navbar: false  
# sidebar: false  
  
# breadcrumb: false  
# pageInfo: false  
# contributors: false  
# editLink: false  
# lastUpdated: false  
# prev: false  
# next: false  
comment: false  
# footer: false  
  
# backtotop: false  
---  
## 第1题 ##

【问题1】  
E1：病人 E2:护理人员 E3:医生  
  
本问题考查顶层DFD。顶层DFD —般用来确定系统边界，将待开发系统看作一个加工，因此图中只有唯一的一个处理和一些外部实体，以及这两者之间的输入输出数据流。题目要求根据描述来确定图中的外部实体。分析题目中的描述，并结合已经在顶层数据流图中给出的数据流进行分析。从中可以看出，与系统的交互者包括病人、医生和医护人员。其中，本地监控定期获取病人的生命特征，病人是生命特征数据来源，医生和护理人员会得到相关报告的结果，如请求病人生命特征报告，并获得相关报告。医生还需要在必要时添加或更新生命特征范围。对应图1-1中数据流和实体的对应关系，可知E1为病人，E2为护理人员，E3为医生。  
  
【问题2】  
D1：生命特征范围文件; D2:日志文件  
D3：病历文件 D4:治疗意见文件  
  
解析：本问题考查0层DFD中数据存储的确定。根据说明中的描述：（2）格式化生命特征：对病人的各项重要生命特征数据进行格式化，然后存入日志文件并检查生命特征(4)维护生命特征范围：医生在必要时（如，新的研究结果出现时）添加或更新生命特征值的正常范围；（6）生成病历：根据日志文件中的生命特征，医生对病人的病情进行描述，形成病历存入病历文件；（8）生成治疗意见：根据日志文件中的生命特征和病历，医生给出治疗意见，如处方等，并存入治疗意见文件。因此，D1为生命特征范围文件，D2为日志文件，D3为病例文件，D4为治疗意见文件。  
  
【问题3】  
![b72a5d1a8e094a02a3e1ff7c8e1712ed.jpg][]  
  
解析：本问题考查0层DFD中缺失的处理和数据流。从说明中的描述及图1-2可知，本地监控之后要对重要生命特征存储日志文件进行格式化，所以在本地监控和格式化生命特征之间缺少了数据流重要生命特征；检查生命特征是对格式化后的生命特征进行检查，所以在格式化生命特征和检查生命特征之间缺少了数据流格式化后的生命特征；根据曰志文件中的生命特征，医生对病人的病情进行描述，形成病历存入病历文件。  
  
【问题4】  
E1和E3之间不可以有数据流，因为数据流的起点和终点中必须有一个是加工（处理）。  
  
解析：本问题考查绘制DFD时的注意事项。在DFD中，每条数据流的起点和终点之一必须是加工（处理)。本题中，医生和护理人员根据查询到的治疗意见对病人进行治疗属于系统之外的行为，所以两个实体之间不可以有数据流。  


## 第2题 ##

【问题1】  
(a) PRIMARY KEY 或 NOT NULL UNIQUE  
(b) REFERENCES职工（职工编号）  
(c) CHECK VALUES IN （'待处理','审理中','结案','撤销'）  
(d) CHECK (立案日期&lt;=结案日期）  
  
本问题考查SQL中的数据定义语言DDL和完整性约束。完整性约束包括三类：实体完整性、参照完整性和用户定义的完整性。实体完整性约束规定关系的主属性不能取空值，关系模型中以主码作为唯一性标识；参照完整性约束规定若属性（或属性组）A是关系R上的主码，B是关系S上的外码，A与B相对应（来自相同的域)，则B取值为空或者来自于R上的某个A的值；用户定义的完整性约束是针对具体的数据库应用而定义的，它反映该应用所涉及的数据必须满足用户定义的语义要求。  
(a)考查实体完整性约束，案件编号是案件关系模式的主码，用关键字PRIMARY KEY或者NOT NULL UNIQUE 表示。  
(b)考查参照完整性约束，主审法官属性参照职工关系模式中的职工编号属性，由于这两个属性名称不同，因此用REFERENCES职工（职工编号）表示，此处不能省略职工编号。  
(c)、(d)考查用户定义的完整性约束。（c）是在状态属性上定义列级约束，用CHECK VALUES IN （'待处理'，'审理中'，'结案'，'撤销'）表示。（d）在立案日期和结案日期上定义约束，用CHECK（立案日期&lt;=结案日期）表示。  
  
【问题2】  
(1) (e)职工.姓名AS主审法官姓名  
(f)案件，被告，律师，职工（关系模式的顺序无关）  
(g)案件.主审法官=职工.职工编号  
(2) (h)立案日期 BETWEEN '01-JAN-2009' AND '31-DEC-2009' 或者立案日期&gt;='01-JAN-2009'AND 立案日期 &lt;='31-DEC-2009，  
(i)ORDER BY 案件数 DESC  
(3) (j)案件.被告=被告.被告编号  
(k)姓名，地址  
(l)HAVING count(\*) &gt; 5  
  
本问题考查SQL中的数据操作语言DML。  
(1)考查别名和连接查询条件。（e）处考核别名定义，用AS关键字，且别名根据题干给出，应填“职工.姓名AS主审法官姓名”；(f)处考查该查询涉及到的关系模式，此处应涉及到案件、被告、律师和职工4个关系模式，在FROM子句中关系模式是顺序无关的；（g）处考核案件关系模式和职工关系模式的连接条件，即“案件.主审法官=职工.职工编号”。  
(2)考查日期属性并对査询结果进行分组和排序。（h）处主要考核日期作为条件属性的语法，题干中已经给出日期格式的提示。在两个日期之间的时间的语法可以用 BETWEEN…AND…，也可以用&gt;=…&lt;=，因此，此处可以填“立案日期BETWEEN '01-JAN-2009' AND '31-DEC-2009' ”或者“立案日期&gt;='01-JAN-2009'AND 立案日期&lt;= '31-DEC-2009'”； (i)处考核查询结果的排序，用“ORDER BY案件数DESC”表示，其中的DESC关键字不能省略。在ORDER BY子句中，若不用表示升序的关键字ASC或表示降序的关键字DESC表示，则默认为升序排序。  
(3)考查对查询结果进行分组，并指定满足条件的分组才能输出。（j）处考核两个关系模式的连接关系，应填“案件.被告=被告.被告编号”；（k）处考核分组，此处填“姓名，地址”，不能仅填姓名或者地址；（1）处考核分组条件，用HAVING关键字，应填“ HAVING count(\*)&gt; 5”。  
  
【问题3】  
(m) INSERT; (n) SET状态='审理中' (o)案件编号=nrow.案件编号  
  
本问题考查触发器。  
触发器是一个能由系统自动执行对数据库修改的语句。一个触发器由事件、条件和动态三部分组成：事件即对数据库的插入、删除和修改等操作。触发器在这些事件发生时，将开始工作；条件是指触发器将测试条件是否成立，若成立就执行相应的动作，否则就什么也不做；动态是指若触发器测试满足预定的条件，那么就由数据库管理系统执行这些动作。本题首先定义触发器的事件，即对审理关系模式插入后激活触发器。接下来定义触发器的动作，即修改案件关系模式的状态为“审理中”，测试条件为若该案件原来状态为“待处理”，需要关联的两个关系模式是案件和审理。  


## 第3题 ##

【问题1】  
![7acbb22f437742ebb3042a2f5f77cecb.jpg][]  
  
本问题考查数据库的概念结构设计，题目要求补充完整实体联系图中的联系和联系的类型。  
根据题目的需求描述可知，一个库管员可以管理多个仓库，每个仓库有一名库管员。所以，仓库实体和库管员实体之间存在“管理”联系，联系的类型为多对一（\*:1）。  
根据题目的需求描述可知，一个仓库中可以存放多类服装，一类服装可能存放在多个仓库中。所以，仓库实体和服装实体之间存在“存放”联系，联系的类型为多对多（\*:\*）。  
根据题目的需求描述可知，一个采购订单可以包含多类服装，每类服装可由多个不同的供应商供应。所以，采购订单实体与服装实体和供应商实体三者之间存在“采购”联系，三者之间联系的类型为多对多对多（\*:\*:\*)。  
根据题目的需求描述可知，一个供应商可以供应多类服装，一类服装可由多个供应商供应。所以，供应商实体和服装实体之间存在“供应”联系，联系的类型为多对多（\*:\*）。  
  
【问题2】  
(1)库管理员编码  
(2)仓库编码，库管员编码  
(3)供应商编码  
(4)供应商编码，服装编码  
(5)订单编码，订货日期，应到货日期  
(6)订单编码，服装编码，供应商编码，数量，采购价格  
  
解析：根据实体联系图和需求描述，仓库信息主要包括：仓库编码、仓库位置、仓库容量和库管员。对于“仓库信息”关系模式，由于仓库实体与库管员实体有多对一联系，需记录对应的库管员，并且需补充属性仓库编码。因此，“仓库信息”关系模式，需补充属性“仓库编码”和“库管员编码”。  
根据实体联系图和需求描述，供应商信息包括：供应商编码、供应商名称、地址、企业法人和联系电话。所以，对于“供应商”关系模式，需补充属性“供应商编码”。  
根据实体联系图和需求描述，“供应情况”关系模式需记录供应商和服装的多对多联系，即一个供应商可以供应多类服装，一类服装可由多个供应商供应。所以，对于“供应商”关系模式，需补充属性“供应商编码”和“服装编码”。  
根据实体联系图和需求描述，采购订单主要记录订单编码、订货日期和应到货日期。所以，对于“采购订单”关系模式需补充属性：订单编码，订货日期，应到货日期。由于采购订单还需详细记录所采购的每类服装的数量、采购价格和对应的多个供应商。因此，“采购订单明细”关系模式，需记录采购订单实体与服装实体和供应商实体三者之间存在的多对多对多联系。对于“采购订单明细”关系模式，需补充属性“订单编码，服装编码，供应商编码，数量，采购价格”。  
  
【问题3】  
![2e3987cbc6d34b18855d95ac65aff630.jpg][]  
  
解析：本问题考查的是数据库的概念结构设计，根据新增的需求增加实体联系图中的实体的联系和联系的类型。  
根据问题描述，多个库管员需对每个仓库中的每一类被抽查服装记录一条抽査结果。则须在库管员实体与仓库实体和服装实体三者之间的存在“抽査”联系，联系的类型是多对多对多（\*:\*:\*）。  


## 第4题 ##

【问题1】  
(1) “校友编号”和“身份证号”。  
(2) “校友信息”关系模式可以达到第二范式，不满足第三范式。  
由于“校友信息”关系模式的主键是“校友编号”，但又包含函数依赖：  
班级一院系，入学年份  
不满足第三范式的要求，即存在非主属性对码的传递依赖。  
  
解析：本问题考查非主属性和第三范式。  
根据“校友信息”关系模式可知，“校友编号”和“身份证号”都是校友信息的决定因素，因此都是候选键的属性。  
根据第三范式的要求：每一个非主属性既不部分依赖于码也不传递依赖于码。  
根据“校友信息”关系模式，其中存在以下函数依赖：  
班级一院系，入学年份  
而由于“校友信息”关系模式的主键是“校友编号”，因而，存在非主属性对码的传递依赖。所以，“校友信息”关系模式可以达到第二范式，但不满足第三范式。  
  
【问题2】  
(1) “捐赠信息”关系不满足第二范式，即非主属性不完全依赖于码。  
(2)会造成：插入异常、删除异常和修改复杂（或修改异常）。  
(3)分解后的关系模式如下：  
捐赠信息1 (捐赠编号，捐赠校友，捐赠时间，捐赠金额，捐赠类型，使用方式）捐赠信息2（受益人身份证号，受益人姓名，受益人所在单位，受益人类型）  
捐赠信息3 (捐赠编号，受益人身份证号，受益金额，使用说明）  
(1)修正后的主键如下：  
捐赠信息1 (捐赠编号，捐赠校友，捐赠时间，捐赠金额，捐赠类型，使用方式）  
捐赠信息2 (受益人身份证号，受益人姓名，受益人所在单位，受益人类型）  
捐赠信息3 (捐赠编号，受益人身份证号，受益金额，使用说明）  
  
解析：本问题考査第二范式和第三范式。  
根据第三范式的要求：非主属性不完全依赖于码。  
根据“捐赠信息”关系模式，可知其码为（捐赠编号，受益人身份证号），而又存在部分函数依赖：  
捐赠编号一捐赠校友，捐赠时间，捐赠金额，捐赠类型，使用方式。  
受益人身份证号一受益人姓名，受益人所在单位，受益人类型。  
所以，捐赠信息”关系不满足第二范式，会造成：插入异常、删除异常和修改复杂(或修改异常)。  
因为存在部分函数依赖，因此对“捐赠信息”进行分解，分解后的关系模式如下：  
捐赠信息1 (捐赠编号，捐赠校友，捐赠时间，捐赠金额，捐赠类型，使用方式）  
捐赠信息2 (受益人身份证号，受益人姓名，受益人所在单位，受益人类型）  
捐赠信息3 (捐赠编号，受益人身份证号，受益金额，使用说明）  
其中，  
“捐赠信息1”关系的函数依赖为：  
捐赠编号一捐赠校友，捐赠时间，捐赠金额，捐赠类型，使用方式。  
“捐赠信息2”关系的函数依赖为：  
受益人身份证号一受益人姓名，受益人所在单位，受益人类型。  
“捐赠信息3”关系的函数依赖为：  
捐赠编号，受益人身份证号一受益金额，使用说明。  
这三个关系中的每一个非主属性既不部分依赖于码也不传递依赖于码，因此满足第三范式的要求。  
  
【问题3】  
(1) “项目受益情况”关系模式，不满足第四范式。  
(2)分解后的关系模式如下：  
项目受益情况1 （项目编号，受益单位，受益比例）  
项目受益情况2 （项目编号，捐赠编号，项目受益金额）  
  
本问题考查的是第四范式。  
根据“项目受益情况”关系模式可知，其码为：项目编号，受益单位，捐赠编号。而又存在部分函数依赖：  
项目编号，受益单位一受益比例  
项目编号，捐赠编号一项目受益金额  
项目编号→→受益单位，受益比例  
项目编号→→捐赠编号，项目受益金额  
同时，可以根据第四范式的要求：不允许有非平凡且非函数依赖的多值依赖。  
而在“项目受益情况”关系模式中存在如下的多值依赖：  
项目编号→→受益单位，受益比例  
项目编号→→捐赠编号，项目受益金额  
因此，“项目受益情况”关系模式不满足第四范式。  
因为存在多值依赖，因此对“项目受益情况”进行分解，分解后的关系模式如下：项目受益情况1（项目编号，受益单位，受益比例）  
项目受益情况2 (项目编号，捐赠编号，项目受益金额）  
其中：  
“项目受益情况1”关系的函数依赖为：项目编号，受益单位一受益比例。  
“项目受益情况2”关系的函数依赖为：项目编号，捐赠编号一项目受益金额。  
这两个关系不存在多值依赖，因此满足第四范式的要求。  


## 第5题 ##

【问题1】  
将写订单记录和修改库存表作为一个完整的事务来处理，当修改库存表无法执行时，回滚事务，则会撤销写入的订单记录，数据库保持一致。  
  
解析：本问题考查事务的基本概念。对于现实中的一项业务，相对应的数据库更新操作应作为一个完整的事务，要么全做要么全不做。销售业务对应的写入订单记录和更新库存表应作为一个事务，当出现故障（违反约束）而无法完成时，应回滚事务。  
  
【问题2】  
(1)出现问题：客户1购买后写入的库存量值被覆盖，库存量不能体现客户1已购买，属于丢失修改造成的数据库不一致性。  
(2)重写后的序列：  
![62af1978c24248368010f37e35bfecde.jpg][]![9fb478e1c63c4e3fb6c4eda8f5d8e0d2.jpg][]  
  
解析：本问题考査对事务并发控制的相关知识的理解掌握。若对并发事务的指令交叉执行不加以干涉，就会相互干扰，破坏事务的隔离性，造成数据库的不一致。并发事务产 的三种不一致性为丢失修改、不可重复读和读脏数据。本例中客户1对库存量的修改被客户2的修改覆盖，出现丢失修改不一致性。  
为保证可串行化调度，在事务执行过程中引入相应指令进行控制，即两段锁协议(2PL),对数据读之前先加读锁，写前加写锁，事务只有获得相应的锁才能操作数据，加解锁过程分为两个阶段，前一阶段只能加锁，后一阶段只能解锁，不允许有交叉。两段锁协议是保证并发事务可串行化调度的充分条件。  
针对给出的伪指令操作序列，需要在修改库存量之前加XlockO指令，并保证客户1释放A上的锁后客户2才能加锁。题目设定插入订单表的操作不需要引入锁指令，每个事务只需对库存量加解锁，满足2PL协议。  
  
【问题3】  
(a) return  
(b) 商品 ID = :MID  
(c) COMMIT  
  
解析：本问题考査对2PL协议理论与SQL中的隔离级别，以及嵌入式SQL的编程实践。  
本题给出的空缺（a）是在事务回滚之后，需要补充的是控制程序逻辑的return语句；空缺（b）要补充的是WHERE条件，即指定的商品ID；空缺（c）要补充的是事务提交语句COMMIT。  



[b72a5d1a8e094a02a3e1ff7c8e1712ed.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第1题/b72a5d1a8e094a02a3e1ff7c8e1712ed.jpg
[7acbb22f437742ebb3042a2f5f77cecb.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第3题/7acbb22f437742ebb3042a2f5f77cecb.jpg
[2e3987cbc6d34b18855d95ac65aff630.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第3题/2e3987cbc6d34b18855d95ac65aff630.jpg
[62af1978c24248368010f37e35bfecde.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第5题/62af1978c24248368010f37e35bfecde.jpg
[9fb478e1c63c4e3fb6c4eda8f5d8e0d2.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第5题/9fb478e1c63c4e3fb6c4eda8f5d8e0d2.jpg
