---  
title: 2018年下半年  
# icon: gears  
order: 991  
category:  
- 历年真题  
tag:  
- 真题  
  
# navbar: false  
# sidebar: false  
  
# breadcrumb: false  
# pageInfo: false  
# contributors: false  
# editLink: false  
# lastUpdated: false  
# prev: false  
# next: false  
comment: false  
# footer: false  
  
# backtotop: false  
---  
## 第1题 ##

试题一（15分）  
阅读下列说明和图，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
智能家居系统以消费者的使用习惯为依据，利用信息系统和自动化控制系统实现人与家用设备之间的信息交换，也就是说，智能家居是对家庭环境中的各个子系统（家电、水电、窗帘、视频监控、服务机器人等）进行互通控制的一套体系。图1-1为某单位设计的以ZigBee、WiFi及GSM为基础构建的集智能控制、安全监控为一体的智能家居系统示意图，依次是：家庭内部以ZigBee为基础的无线系统、用来进行视频传输的WiFi 网络和用来外部交互的外部交互网络。  
![21cf44ddc8a849e28faeeae8a5816881.jpg][]  
安全视频监控系统利用WiFi网络同家庭PC主机连接，用户可以通过外网或者内部WiFi连接，实时监控家庭状态，或者当家庭内部出现紧急事件后，可以通过GSM网络向家庭用户发送短信或彩信。  
王工计划为某小区设计一套智能家居系统，利用ZigBee技术的低功耗、自组织、可扩展等特点，组建家庭内部无线传感器网络，网络节点包括室内温湿度采集节点、火灾环境监测节点、模拟空调控制节点、模拟雨水窗户监控节点。王工在开发智能家居系统时采用V开发模型，V幵发模型强调软件开发的协作和速度，将软件实现和验证有机结合起来，在保证较高的软件质量情况下缩短开发周期，图1-2为V模型示意图。该模型中，每个开发活动都有对应的验证活动，在进行客户需求分析时，测试人员可以了解产品设计特性、用户真正的需求，确定测试目标，可以准备用例并策划测试活动；在软件需求分析阶段，测试人员可以了解实现的过程、评审需求，设计测试方案和计划，并准备测试环境，设计系统或配置项测试用例；在软件概要设计阶段，测试人员可以评审概要设计，设计软件集成方案和用例：在详细设计阶段，测试人员可以评审详细设计，设计单元测试用例；在编码阶段，测试人员可以评审代码，并执行单元测试。  
![ad7adc68c15d4d5e94c611ce67e298d4.jpg][]  
  
【问题1】（4分）  
在图1-2所示的V模型中，与开发阶段中概要设计对应的测试阶段称为（1）。在系统或配置项测试阶段应采用（2）方法。  
  
【问题2】（5分）  
完成下面对图1-2所示的V模型的论述，将答案填写在答题纸的对应栏中。  
1.客户需求分析对应验收测试。在进行需求分析、功能设计的同时，测试人员就可以阅读、审查分析结果，了解产品设计特性、用户真正的需求，从而确定（1）。  
2.进行软件需求分析时，测试人员可了解实现的过程、评审需求，可设计（2）和（3）。  
3.设计人员做详细设计时，测试人员可参与设计，对设计进行（4）,同时（5）, 并基于用例开发测试脚本。  
  
【问题3】（6分）  
ZigBee协调器是整个ZigBee家庭内网的核心,负责管理各个ZigBee节点设备与PC网关的信息和控制指令的传输。温湿度采集终端将传感器的数据以点播的形式发送给协调器，其他采集/控制节点以广播的形式与ZigBee协调器进行数据的交换，协调器和PC 采用串口通信协议。协调器上电后，首先进行系统初始化，信道扫描、创建信道并组建网络。如果组建网络成功，则进行各层事件扫描；如果失败，则继续创建，如果检测到应用层有事件，则对事件进行处理；否则反复扫描各层事件。当应用层有事件，则检査数据类型。如果是室内环境数据，则经过串口发送到网关；如果不是室内环境数据，则进一步判断是否为控制指令；如果是，则向控制节点发送控制指令。ZigBee协调器软件流程图如图1-3所示。补充图1-3中的（1）~（4），并将答案填写在答题纸的对应栏中。  
![cb5b07e231f84f2b8af27f02acd8210f.jpg][]  


## 第2题 ##

试题二（15分）  
阅读下列说明和图，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
在智能家居系统设计中，李工被分配进行ZigBee协调器、信息采集器节点、终端控制节点和安全视频监控系统的部分硬件电路原理设计。  
李工在基于微处理器的ZigBee协调器设计中，使用四个LED灯（D1、D2、D3、D4)表示状态，四个LED灯分别接到处理器的P2\_0、P2\_1、P2\_2和P2\_3管脚，部分相关的硬件设计如图2-1所示。  
![96d35d50d67e45acb4135105e36366de.jpg][]  
李工在CO2的信息采集器节点设计中，采用红外传感器T6004进行CO2信息收集，T6004利用CO2可以吸收特定波段红外辐射的原理，同时内置温度补偿，与控制器CC2530进行连接，部分相关的硬件设计如图2-2所示。T6004传感器的工作电压为5V，CC2530控制器的工作电压为2.0~3.6V。  
![f1698d02b4284561a11e6a48e13a44a7.jpg][]  
李工在空调终端控制节点设计中，采用红外遥控电路中的红外发光二极管将调制好的红外光波发送给空调的红外接收电路，部分相关的硬件设计如图2-3所示，处理器通过P1\_4管脚进行红外光波的发送。  
![c74beab006e3496a8a24cfe81883a487.jpg][]  
李工设计的安全视频监控系统原理示意图如图2-4所示。主处理器采用T1的DM6446,该处理器包括ARM子系统，DSP子系统，视频处理子系统等，前端模拟视频通过TVP5146进行（可接2路模拟视频输入，分别是V1和V2)采集，TVP5146将模拟视频数据转换为10bit的YCbCr4:2:2数字格式，然后送到主处理器。主处理器通过I2C总线可以对TVP5146进行配置（TVP5146接口电压为3.3V)，TVP5146和主处理器之间接口包括：l0bit数字视频信号、时钟信号、行场同步信号。DM6446主处理器的视频信号接口、I2C接口工作电压为1.8V。  
![6f8a0d44c2aa40278a1cf83d0ebf83b0.jpg][]  
  
【问题1】（4分）  
在ZigBee协调器设计中，按照需求李工定义了四个LED灯的状态含义，分别是：D1 “亮”表示协调器已启动，“灭”表示协调器未启动；D2 “亮”表示有外围信息采集器节点已加入到ZigBee网络，“灭”表示目前无节点加入网络；D3 “亮”表示有终端控制节点已加入到ZigBee网络，“灭”表示目前无节点加入网络；D4 “亮”表示协调器正在通过串口和PC主机进行数据通信，“灭”时表示目前没有数据通信。  
如果当前ZigBee协调器处于启动状态、且只有CO2外围信息采集器连入ZigBee网络，没有任何终端控制节点连接，协调器正在通过串口向PC主机发送CO2的采集信息，在这种情况下，P2\_0、P2\_1、P2\_2和P2\_3应该分别输出什么电平（回答高电平或低电平）？  
  
【问题2】（5分）  
1. 在图2-2的CO2信息采集器设计中，两个IN4007(U3和U4)的作用是什么？  
2. 为了使得红外发光二极管发射，图2-3中的P1\_4应该输出高电平还是低电平？  
3. 在图2-4中,连接主处理器DM6446和TVP5146之间SN74AVC芯片的作用是什么？  
  
【问题3】（6分）  
在使用I2C接口对TVP5146进行配置时，DM6446为主，TVP5146为从。在每次写寄存器配置操作中，需要主先发送设备从地址、再发送待操作的寄存器地址、最后发送待写入的数据，并且每次主向从发送消息，都需要接收到从的应答后，才能进入下一步操作。  
在调试过程中，李工希望通过I2C来配置TVP5146的视频标准模式，对应的寄存器地址和各个Bit位的含义如表2-1所示。  
![9cd92c9eb4314105b32f4ce2bf3c2fc3.jpg][]  
假设当前TVP5146的I2C地址为0x64 (设备从地址)，李工希望将该TVP5146配置为NTSC525视频标准，请从以下A~I中选择合适的操作，补充到图2-5中的空（1）~（6）处。  
A. 通过I2C发送寄存器地址00h  
B. 通过I2C发送寄存器地址02h  
C. 通过I2C发送数据01h  
D. 通过I2C发送数据03h  
E. 通过I2C发送设备从地址64h  
F. 通过I2C发送设备从地址60h  
G. 等待TVP5146应答  
H. 向TVP5146发送回应  
I. 是否有中断发生  
![226a53fa8fcf4490980448d903491150.jpg][]  


## 第3题 ##

试题三（15分）  
阅读下列说明和图，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
在智能家居系统软件设计中，家庭内网节点软件设计包括协调器软件、现场采集/ 执行器（室内温湿度采集节点、模拟台灯控制节点、模拟雨水窗户监控节点、模拟空调控制节点和火灾检测节点）的软件设计。软件功能组成如图3-1所示。  
![d8bb81112dc24dee8d30fa61c4ecd833.jpg][]  
整个系统中，协调器是整个家庭内网的核心，负责管理各个节点设备与PC网关的信息和控制指令的传输。温湿度采集终端将传感器的数据以点播的形式发送给协调器，其他采集/控制节点以广播的形式与协调器进行数据的交换，协调器和PC采用串口通信协议。协调器软件主要完成以下功能：  
(1) 创建信道，组建网络；如果失败，则继续创建；  
(2) 组建网络成功，则进行各层事件扫描；  
(3) 如果检测到应用层有事件，则转第（4）步，否则反复扫描各层事件；  
(4) 判断数据类型，如果是室内环境数据，则经串口发送到网关：如果是控制指令，则叫控制节点发送控制指令；如果前面两者均不是，则不处理；  
(5) 继续扫描各层事件。  
  
【问题1】（3分）  
在本软件开发过程中，开发人员使用了基于模型的嵌入式代码生成技术，目前对模型验证最主要的方法是（1）,通过此方法验证后，利用此验证结果可对模型的覆盖率进行分析，模型的覆盖率类型一般包括（2）(至少写出两种类型)。  
  
【问题2】（6分）  
为了测试此软件功能，测试人员设计了表3-1所示的测试用例，请填写该表中的空（1）~（3）。  
![e7263581bd7344cbbcb7dd5449f6aebf.jpg][]  
  
【问题3】（6分）  
覆盖率是度量测试完整性的一个手段，也是度量测试有效性的一个手段。在嵌入式软件白盒测试过程中，通常以语句覆盖率、条件覆盖率和MC/DC覆盖率作为度量指标。  
在实现第4条功能时，设计人员采用了下列算法：  
if ((数据有效==TRUE) && (数据类型==室内环境数据))  
\{数据经串口发送到网关；\}  
if ((数据有效=TRUE) && (数据类型==控制指令))  
\{向控制节点发送控制指令；\}  
请指出对上述算法达到100%语句覆盖、100%条件覆盖和100%MC/DC覆盖所需的最少测试用例数目，填写在表3-2的空（1）~（3）中。  
![b5cee873cf3046c7a19ca204aceaa0b7.jpg][]  


## 第4题 ##

试题四（15分）  
阅读下列说明和图，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
随着汽车工业的飞速发展，越来越多的车上的原有机械控制装置正在被电子控制装置所取代，这是典型的实时控制系统，例如用于控制发动机、自动变速箱、防抱死系统、电子稳定控制系统、牵引力控制系统、刹车辅助系统的ECU和用于座位调整、车窗玻璃升降、车顶移动的电子产品，这在很大程度上提高和完善了汽车的性能和技术水平。但是，汽车上电控系统的多样化和系统结构的复杂化，也直接导致相应的汽车电子软件开发难度越来越高。  
某汽车的ECU（Electronic Control Unit,电子控制单元）系统，采用某高性能的多核处理器，软件架构米用符合AUTOSAR (AUTOmotive Open System Architecture,汽车开放系统架构）标准的多核操作系统，将多个控制应用集成在一个处理器上运行，降低了系统设计的成本、体积、功耗。  
  
【问题1】（5分）  
AUTOSAR中定义了应用任务有四种不同的状态，其状态之间的切换如图4-1所示。  
![5ae0fe9e78384771869d15b1b61cf010.jpg][]  
请从以下状态选项中为（1）~（5）选择正确的状态编号，并将答案填写在答题纸的对应栏中。  
A. 触发  
B. 启动  
C. 挂起  
D. 被抢占  
E. 创建  
F. 激活  
G. 删除  
H. 时间片用完  
  
【问题2】（4分）  
(1) 该系统中任务的优先级是静态分配的，在某些特定的情况下，多任务抢占资源会发生死锁，解决的策略一般是采用优先级天花板方式。请简述优先级天花板的原理。  
(2) 该系统采用了多核处理器，多核处理器一般有SMP和AMP两种不同的工作方式。请简述SMP和AMP的差异。  
  
【问题3】（6分）  
该ECU系统在上电、复位或唤醒后，首先进入Boot模式，进行开或者关，对FLASH 和RAM进行初始化，然后进入用户程序，用户程序是从cstart函数开始执行的，在多核嵌入式系统中通常是先进行主核的cstart，主核自身进行部分初始化后将从核从HALT 状态激活，然后主核和从核在完成各自必要的设置后分别进入各自的main函数。图4-2 是该系统多核处理器的启动流程，请补充空（1）~（3）的内容，将解答填写在答题纸的对应栏中。  
![af16264532c14212bae4b18d0ba47e66.jpg][]  


## 第5题 ##

试题五（15分）  
阅读下列说明和C语言代码，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
在某工厂的物流车间，设计一款智能监测系统，实现对车间进行24小时不间断图像采集的功能。王工设计了一个实时监测采集系统，主要由图像采集卡和数据存储卡组成。由于实时图像的数据量巨大，设计采用DMA方式进行数据传输，当DMA传输完成后，DMA控制器会发起一个硬件中断。操作系统接收到硬件中断，调用中断服务程序。  
该系统的软件基于某嵌入式操作系统开发，支持中断管理、多任务调度等功能。与DMA相关的一段驱动程序示例代码如下。  
![3baf7a2306f14ee5b140ef3265acba77.jpg][]  
![cdc2a1354c344f30be263227800cbd92.jpg][]  
![c139f8a3fe82456da6b9e48a02cd0ee3.jpg][]  
  
【问题1】（5分）  
在操作系统的头文件中，有如下类型定义：  
![a7f5b8c14270429592ceee55f370312d.jpg][]  
1. 该类型定义了一组什么类型的变量，简述其功能。  
2. 在程序1的dma\_init 函数中，应该将intConnec t函数的第二个参数转换成相应的类型，可以消除编译警告，请补充其中空（1）的内容。  
  
【问题2】（4分）  
DMA控制器的寄存器操作序列，必须为原子操作，该程序中使用了两个信号量，一个用于进行寄存器操作系统的临界区保护，一个用于在传输函数和DMA完成中断处理程序之间同步。请根据信号量创建时的不同初始值，在程序2的dma\_trans函数和程序3 dma\_intHandle 函数中，补充空（2）、（3）、（4）、（5）处的内容。  
  
【问题3】（6分）  
在该系统中有A、B两个应用任务同时从不同角度采集图像，都需要调用该DMA传输函数，任务A和任务B的优先级相同。该系统采用优先级抢占的调度策略。在任务A调用DMA传输函数进行DMA传输时，有时会出现函数返回值为0的情况。根据DMA 控制器的芯片手册定义，1表示正常完成，2表示传输超时，4表示奇偶校验错，所以返回值不应该为0。  
王工经过认真排查后，分析该故障发生的原因是当任务A调用dma\_trans函数时，会发生任务suspend的情况，此时如果任务B也调用dma\_trans函数，则会发生上述故障。  
1. 请给出dma\_trans函数中会导致任务发生阻塞的代码行号。  
2. 按照王工的分析，对全局变量的不正确操作会导致该函数的返回值错误，请给出发生错误的代码行号。  
3. 王工对该程序进行了改进，将上述会导致返回值错误的代码放在某一行程序之后执行，即可解决该问题，请给出代码行号。  
注意：这里的行号是指程序2中注释所标的第1行到第5行，请在第1行到第5行之中选择。  
  


## 答案及解析 ##

  



[21cf44ddc8a849e28faeeae8a5816881.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第1题/21cf44ddc8a849e28faeeae8a5816881.jpg
[ad7adc68c15d4d5e94c611ce67e298d4.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第1题/ad7adc68c15d4d5e94c611ce67e298d4.jpg
[cb5b07e231f84f2b8af27f02acd8210f.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第1题/cb5b07e231f84f2b8af27f02acd8210f.jpg
[96d35d50d67e45acb4135105e36366de.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第2题/96d35d50d67e45acb4135105e36366de.jpg
[f1698d02b4284561a11e6a48e13a44a7.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第2题/f1698d02b4284561a11e6a48e13a44a7.jpg
[c74beab006e3496a8a24cfe81883a487.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第2题/c74beab006e3496a8a24cfe81883a487.jpg
[6f8a0d44c2aa40278a1cf83d0ebf83b0.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第2题/6f8a0d44c2aa40278a1cf83d0ebf83b0.jpg
[9cd92c9eb4314105b32f4ce2bf3c2fc3.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第2题/9cd92c9eb4314105b32f4ce2bf3c2fc3.jpg
[226a53fa8fcf4490980448d903491150.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第2题/226a53fa8fcf4490980448d903491150.jpg
[d8bb81112dc24dee8d30fa61c4ecd833.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第3题/d8bb81112dc24dee8d30fa61c4ecd833.jpg
[e7263581bd7344cbbcb7dd5449f6aebf.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第3题/e7263581bd7344cbbcb7dd5449f6aebf.jpg
[b5cee873cf3046c7a19ca204aceaa0b7.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第3题/b5cee873cf3046c7a19ca204aceaa0b7.jpg
[5ae0fe9e78384771869d15b1b61cf010.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第4题/5ae0fe9e78384771869d15b1b61cf010.jpg
[af16264532c14212bae4b18d0ba47e66.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第4题/af16264532c14212bae4b18d0ba47e66.jpg
[3baf7a2306f14ee5b140ef3265acba77.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第5题/3baf7a2306f14ee5b140ef3265acba77.jpg
[cdc2a1354c344f30be263227800cbd92.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第5题/cdc2a1354c344f30be263227800cbd92.jpg
[c139f8a3fe82456da6b9e48a02cd0ee3.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第5题/c139f8a3fe82456da6b9e48a02cd0ee3.jpg
[a7f5b8c14270429592ceee55f370312d.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第5题/a7f5b8c14270429592ceee55f370312d.jpg
## 第1题 ##

【问题1】  
(1) 部件测试或组件测试或集成测试  
(2) 灰盒测试  
  
本题考查嵌入式系统设计的能力。  
智能家居系统是一个典型的嵌入式分布式系统、一个网络系统，本题考查学生对嵌入式系统分析、设计、测试等以及软件开发的综合能力。  
V模型是在快速应用幵发模型基础上演变而来的，由于将开发过程构造成个V字型而得名，V模型强调软件开发的协作和速度，将软件实现和验证有机结合起来，在保证较高的软件质量情况下缩短开发周期。  
空（1）处对应概要设计。在软件工程中，以概要设计为测试依据的测试级别应为集成测试或部件测试，所以空（1）处的正确答案应为部件测试或组件测试或集成测试。  
空（2）处的测试方法应为系统或配置项测试的测试方法。系统或配置项测试时，应该主要使用黑盒测试方法，但对一些特殊功能的测试还要对照代码使用白盒测试方法进行验证，所以应为灰盒测试方法。所以空（2）处的正确答案应为灰盒测试。  
  
【问题2】  
(1) 测试目标  
(2) 测试方案和计划  
(3) 系统或配置项测试用例  
(4) 评审  
(5) 设计单元测试用例  
  
图1-2所示的V模型中可以看出，左边是设计和分析，是软件设计实现的过程，同时伴随着质量保证活动一审核的过程，也就是静态的测试过程；右边是对左边结果的验证，是动态测试的过程，即对设计和分析的结果进行测试，以确认是否满足用户的需求。  
在进行客户需求分析时，测试人员就可以阅读、审查需求分析的结果，从而了解产品的设计特性、用户的真正需求，确定测试目标，可以准备用例（Use Case)并策划测试活动。  
在软件需求分析阶段，测试人员可以了解实现的过程、评审需求，设计测试方案和计划，并准备测试环境，设计系统或配置项测试用例。  
当系统设计人员在做系统设计时，测试人员可以了解系统是如何实现的，基于什么样的平台，这样可以设计系统的测试方案和测试计划，并事先准备系统的测试环境，包括硬件和第三方软件的采购。这些准备工作实际上是要花去很多时间。  
当设计人员在做详细设计时，测试人员可以参与设计，对设计进行评审，找出设计的缺陷，同时设计单元测试用例，完善测试计划，并基于这些测试用例开发测试脚本。  
在编程的同时，测试人员可以评审代码，并执行单元测试。进行单元测试是一种很有效的办法，可以尽快找出程序中的错误，充分的单元测试可以大幅度提高程序质量、减少成本。  
从中可以看出，V模型使人们能清楚地看到质量保证活动和项目同时展开，项目一启动，软件测试的工作也就启动了，避免了瀑布模型所带来的误区，即软件测试是在代码完成之后进行的误区。  
  
【问题3】  
(1) 系统初始化  
(2) 组网成功  
(3) 检查数据类型  
(4) 向控制节点发送控制指令  
  
该问题属于嵌入式系统详细设计部分，需设计ZlgBee协调器软件。ZigBee协调器是整个ZigBee家庭内网的核心，负责管理各个ZlgBee节点设备与PC网关的信息和控制指令的传输。温湿度采集终端将传感器的数据以点播的形式发送给协调器，其他采集/ 控制节点以广播的形式与ZigBee协调器进行数据的交换，协调器和PC机采用串口通信协议。  
依据题意，ZigBee协调器软件首先进行系统初始化，所以（1）填写“系统初始化”; 接下来ZigBee协调器软件信道扫描、创建信道并组建网络。如果组建网络成功，则进行各层事件扫描；如果失败，则继续创建，如果检测到应用层有事件，则对事件进行处理; 否则反复扫描各层事件。所以，（2）判断“组网成功”。  
当应用层有事件，则检查数据类型。如果是室内环境数据，则经过串口发送到网关; 如果不是室内环境数据，则进一步判断是否为控制指令，如果是，则向控制节点发送控制指令。所以（3）填写“检查数据类型”，(4)填写“向控制节点发送控制指令”。  


## 第2题 ##

【问题1】  
P2\_0：低电平 P2\_1：低电平 P2\_2：高电平 P2\_3：低电平  
  
本题考查嵌入式系统硬件设计中所涉及的基本内容，包括硬件设计屮基木电路的作用，尤其是特殊通信接口的连接方式和工作原理，以及对应的嵌入式硬件寄存器的配置流程。  
此类题目要求考生认真阅读题目，对给出的电路原理图进行仔细分析，根据基本的硬件知识回答问题。  
根据该问题给出的题干，在ZigBee协调器设计中，李工定义了四个LED灯的状态含义，分別是：D1 “亮”表示协调器已启动，“灭”表示协调器未启动；D2 “亮”表示灯外闱信怠采集器节点已加入到ZigBee网络，“火”表示目前无节点加入网络；D3 “亮”表示有终端控制节点已加入到ZigBee网络，“火”表示目前无节点加入网络；D4 “亮”表示协调器正在通过串口和PC主机进行数据通信，“灭”时表示目前没有数据通信。  
如果当前ZlgBee协调器处于启动状态且只有CO2外围信息采集器连入ZigBee网络，没有任何终端控制节点连接，协调器正在通过串口向PC主机发送CO2的采集信息，在这种情况下，协调器已经启动（D1亮)、有外围的信息采集器连接到网络（D2亮)、没有控制节点连接到网络（D3灭）、正在进行通信（D4亮)。根据该内容判断，结合电路中要使得灯亮时候的电平控制，可以很容易知道P2\_0为低电平（D1灯亮)，P2\_1为低电平(D2灯亮)，P2\_2为高电平(D3灯火)，P2\_3为低电平(D4灯亮)。  
  
【问题2】  
(1) 降压  
(2) 高电平  
(3) 电平转换  
  
在该题干中已经说明：T6004传感器的工作电压为5V, CC2530控制器的工作电压为2.0~3.6V。在图2-2的CO2信息采集器设计中，两个IN4007 (U3和U4)的最左端输入电乐为5V,所以可知其作用为降压功能，目的是为了进行电压匹配。  
为了使得红外发光二极管发射，图2-3中的P1\_4应该输出高电平才可以使得三极管导通，进而才可以使得灯亮。  
在图2-4中，DM6446的IO口工作电压是1.8V，而TVP5146芯片的接口工作电压是3.3V, 因此连接二者的SN74AVC芯片可以起到电平转换的作用，实现TVP5146和SN74AVC 二者在进行数据通信中的电压匹配。  
  
【问题3】  
(1) E  
(2) G  
(3) B  
(4) G  
(5) C  
(6) G  
  
根据题干可知，在使用I2C接口对TVP5146进行配置时，DM6446为主，TVP5146为从。在每次写寄存器配置操作中，需要主先发送设备从地址（通过I2C发送设备从地址64h)并等待TVP5146应答，在回应通过后再发送待操作的寄存器地址（通过I2C发 送寄存器地址02h，该寄存器地址由表2-1可知）并等待从设备的回应，在等待到正确的回应后最后发送待写入的数据（通过I2C发送数据01h，数据寄存器的内容由配置的模式来决定，题目中给定的模式对应的寄存器值为01h),待接收到正确的回应后配置寄存器的过程才算完成。  


## 第3题 ##

【问题1】  
![9038b891469d4d42a33dcee3c979424d.jpg][]  
  
本题考查软件测试的一些基本概念和方法在测试实践中的应用，特别是针对目前基于模规开发软件的验证技术。  
软件测试过程中，测试人员不仅需要熟悉一些基本的测试概念和测试方法，而且需要通过对软件设计和算法的理解，运用测试方法进行基于需求的测试用例设计，同时需要根据不同的覆盖率要求保证设计测试用例的充分性。  
此题目要求考生认真阅读题目所给的软件需求和算法信息，结合嵌入式软件测试的基木概念和测试用例设计要求，在此嵌入式软件测试中进行实际应用。  
随着嵌入式软件规模越来越大，可靠性要求越来越高，采用基于模型的开发方法已成为发展趋势。特别是一些基于模型的开发工具自带的代码生成器已经经过鉴定，其生成的代码已经不需要进行白盒测试。所以对基于模型开发的软件测试来说，模型的验证方法就尤为关键，因为模型的正确性决定着代码的正确性。  
目前对模型采取的验证方法包括评审、分析和仿真。评审和分析都是静态的验证方法，而仿真属于动态验证方法。通过动态仿真模型，可以发现模型动态运行过程中的一些问题。仿真完成后，可以根据动态仿真结果分析模型的覆盖率，而静态验证方法评审和分析的结果就不能作为模型覆盖率分析的基础。所以根据这些内容可知，问题1的模型验证最主要的方法是仿真。  
模型的覆盖率类型主要包括条件覆盖、分支（或判定）覆盖、MC/DC覆盖、插值表覆盖、佶号范围覆盖、组合逻辑块覆盖等。目前的工程实践中，经常使用的覆盖率类型包括条件覆盖、分支（或判定）覆盖和MC/DC覆盖。考生可从这三种常用类型中选择两种类型，也可从全部覆盖类型中任意选择两种类型。  
  
【问题2】  
![ca96574d6876404bb56b6634b639ac63.jpg][]  
  
为了测试某智能家居系统中家庭内网节点软件的功能，就要依据题目说明中的家庭内网节点软件功能组成图和功能描述，进行测试用例的设计。此题考査测试用例的设计能力，不仅包括输入数据的设计，还包括前置条件（例如是否组网成功）及预期输出的设计（例如进行各层事件扫描还是向相应的节点发送数据），条件较多，需要综合考虑。  
序号1，无前置条件，输入为创建信道成功，依据第2条设计说明，输出应为进行各层事件扫描。  
序号2，前置条件为组网成功，输入为数据类型有效，输出为经串口将室内温度数据发送到网关，依据第4条设计说明的“如果是室内环境数据，则经串口发送到网关”, 输入应该包括数据类型有效且数据为室内温度数据。  
序号3，前置条件为组网成功，输入为数据类型有效且为台灯控制指令，依据第4 条设计说明的“如果是控制指令，则向控制节点发送控制指令”，输出应为向控制节点发送控制指令，此输入为台灯控制指令，则输出应该为向台灯控制节点发送控制指令。  
  
【问题3】  
(1) 2  
(2) 2  
(3) 4  
  
此题目主要考查对语句覆盖、条件覆盖和MC/DC覆盖概念的掌握以及应用。  
语句覆盖要求设计适，数量的测试用例，运行被测程序，使得程序中每一条语句至少被运行一遍，语句覆盖在测试中主要发现错误语句。  
条件覆盖要求设计适当数量的测试用例，运行被测程序，使得程序中每个判断中的每个条件的真值分支和假值分支至少执行一次，但未必能覆盖全部分支。  
修正判定条件覆盖（MC/DC)要求设计适当数量的测试用例，保证在一个程序中每种输入输出至少得出现一次，在程序中的每-个条件必须产生所有可能的输出结果至少一次，并且每个判断中的每个条件必须能够独立影响一个判断的输出，即在他条件不变的前提下仅改变这个条件的值，而使判断结果改变。  
按照上述语句覆盖要求，语句覆盖就要使得问题3中的所打语句执行一次，问题3中有两个语句块。由于数据有效时，数据类型不可能既是室内环境数据，又是控制指令，二者只能为其一，故为了使问题3中的两个语句块执行一次，至少需要2个测试用例来覆盖。  
按照上述条件覆盖要求，条件覆盖要使得程序中每个判断中的每个条件的真值分支和假值分支至少执行一次。对问题3中的判断语句进行分析：有两个判断语句，每个判断语句打两个判断条件，需要覆盖两个判断语句中的四个条件，取第一个判断的TT (TRUE和TRUE)和第二个判断语句FT (FALSE和TRUE)即可满足。因为这两个判断中的第一个条件相同，并且第二个条件互斥（即一个为真时，另一个一定为假）。所以，取第一个判断语句的TT时，同时满足了第二个判断语句的TF;当取第二个判断语句的FT时，同时满足了第一个判断语句的FF条件。这样两个判断语句中的条件的所有值都被覆盖到，故最少需要2个测试用例来满足条件覆盖要求。但是这两个条件覆盖并未满足分支覆盖。  
按照上述MC/DC覆盖要求，即每个判断中的每个条件必须能够独立影响个判断的输出。对问题3中的两个判断进行分析：每个判断有两个条件，两个条件共打四种组合，即TT (TRUE 和TRUE)、TF (TRUE 和FALSE)、FT (FALSE和TRUE)和FF (FALSE 和FALSE)。但是由于这两个判断均为逻辑与条件，当前一个条件为FALSE时，其整个判断值为FALSE,后一个条件的真或假均不能独立影响整个判断的输出，所以对每个判断只需要TT、TF和FX (X表示后一个条件为TRUE或FALSE都可以）三种情况就可以。同时由于这两个判断中的第一个条件相同，并且第二个条件互斥（即一个为真时，另一个一定为假)。所以第一个判断的FX与第二个判断的FX相同，可共用一个测试用例覆盖，故对两个判断的FX仅需要1个用例即可；同时当执行第一个判断的TT用例时，也一定执行了第二个判断的TF用例，但是当执行第一个判断的TF用例时，未必能执行第二个判断的TT。所以为了问题3的MC/DC覆盖，最少需要执行第一个判断的TT、TF和FT，以及第二个判断的TT，故总共需要4个测试用例即可满足MC/DC覆盖要求。  


## 第4题 ##

【问题1】  
(1) C  
(2) F  
(3) A  
(4) B  
(5) D  
  
本题考查嵌入式操作系统相关的基础知识。  
汽车开放系统架构（AUTomotive Open System Architecture，AUTOSAR)是由全球汽车制造商、部件供应商及其他电子、半导体和软件系统公司联合建立，各成员保持开发介作伙伴关系。自2003年起，各伙伴公司携手合作，致力于为汽车工业开发一个开放的、标准化的软件架构。AUTOSAR这个架构有利于车辆电子系统软件的交换与更新，并为高效管理愈来愈复杂的车辆电子、软件系统提供了一个基础。此外，AUTOSAR在确保产品及服务质量的同时，提高了成本效率。  
AUTOSAR中定义的任务分为两个类别：  
•基础任务：只有运行、阻塞、就绪三个状态。基础任务在三种情况下释放处理器资源：任务结束；操作系统切换到高优先级任务；中断发生导致处理器切换到一个中断服务程序ISR。  
•拓展任务：较之基础任务，多了一个等待状态。拓展任务被允许调用系统服务WaitEvent。  
每个任务状态的特点如下：  
•运行状态，在任何时间点只有一个任务能处于运行状态，CPU将会被分配到该任务，该任务的指令将被执行。  
•就绪状态，所有的任务要转换为运行状态都必须先处于就绪状态，处于就绪状态的任务只需等待分配处理器就能转换为运行状态。调度器决定哪一个就绪状态的任务将是下一个执行的任务。  
•阻塞状态，处于阻塞状态的任务是被动的，可以被激活。  
•等待状态，处于等待状态的任务将不能继续执行，它将等待至少一个事件发生。  
任务状态的转换原则如F：  
•触发：一个新的任务被设置成就绪状态通过一个系统服务。AUTOSAR操作系统将确保任务从第一条指令开始执行。  
•启动：一个就绪状态的任务被调度器选择去执行。  
•被强占：调度器决定去执行另一个任务，使得运行状态任务进入就绪状态。  
•挂起：运行状态任务通过调用系统服务导致它的状态转换为阻塞状态。  
•等待：通过一个系统服务引起状态转换到等待状态，等待任务等待一个事件，以能够继续操作。  
•激活：至少一个任务等待的事件发生。  
  
【问题2】  
(1) 优先级天花板是当任务申请某资源时，把该任务的优先级提升到可访问这个资源的所有任务中的最高优先级，这个优先级称为该资源的优先级天花板。  
(2) SMP是对称多处理技术，多个内核由一个操作系统管理。AMP是非对称多处理技术，每一个内核由一个操作系统管理。  
  
(1)当一个高优先级任务通过信号量机制访问共享资源时，该信号量已被一低优先级任务占有，会出现优先级翻转的情况，造成高优先级任务被许多具有较低优先级任务阻塞，实时性难以得到保证。  
例如，有优先级为A、B和C三个任务，优先级A&gt;B&gt;C，任务A、B处于挂起状态，等待某一事件发生，任务C正在运行，此时任务C开始使用某一共享资源S。在使用中，任务A等待事件到来，任务A转为就绪态，因为它比任务C优先级高，所以立即执行。当任务A要使用共享资源S时，由于其正在被任务C使用，因此任务A被挂起，任务C开始运行。如果此时任务B等待事件到来，则任务B转为就绪态。由于任务B优先级比任务C 高，因此任务B开始运行，直到其运行完毕，任务C才开始运行。直到任务C释放共享资源S后，任务A才得以执行。在这种情况下，优先级发生了翻转，任务B先于任务A运行。  
解决优先级翻转问题有优先级天花板（priority ceiling)和优先级继承（priority inheritance)两种办法。  
优先级天花板是指当任务申请某资源时，把该任务的优先级提升到可访问这个资源的所有任务中的最高优先级，这个优先级称为该资源的优先级天花板。这种方法简单易行，不必进行复杂的判断，不管任务是否阻塞了高优先级任务的运行，只要任务访问共享资源都会提升任务的优先级。  
优先级继承是当任务A申请共享资源S时，如果S正在被任务C使用，通过比较任务C与自身的优先级，如发现任务C的优先级小于自身的优先级，则将任务C的优先级提升到自身的优先级，任务C释放资源S后，再恢复任务C的原优先级。这种方法只在占有资源的低优先级任务阻塞了高优先级任务时才动态的改变任务的优先级，如果过程较复杂，则需要进行判断。  
(2) 目前支持多核处理器平台的实时操作系统体系结构有对称多处理SMP (Symmetric Multi-Processing)构架和非对称多处理AMP (Asymmetric Multi-Processing)构架两种。这两种操作系统的结构、代码和数据区的分配方面差别很大。SMP构架的系统中所有CTU共享系统内存和外设资源，由一个操作系统负责处理器间协作，并保持数据结构的一致性，而在AMP构架的系统中，用户需要对每个CPU内核上运行的操作系统使用的硬件资源进行划分，CPU间的合作仅限于使用共享存储器的情况。由于CPU间的合作程度不同，AMP 则称为松散耦合多CPU系统，SMP系统称为紧耦合多CPU系统。  
  
【问题3】  
(1) 对FLASH和RAM进行初始化  
(2) 主核把从核由HALT状态激活  
(3) 从核执行相关初始化设置  
  
多核处理器在上电、复位或唤醒后，主核首先进入Boot模式，设置锁步核，对FLASH 和RAM进行初始化，对内核进行部分初始化，然后进入用户程序。用户程序是从cstart 函数开始执行的，在多核嵌入式系统中通常是先进行主核的cstart,主核自身进行部分初始化后将从核从HALT状态激活，从核执行相关初始化设置，然后主核和从核在完成各自必要的设置后分别进入各自的main函数。  


## 第5题 ##

【问题1】  
1. 函数指针。函数指针是指向函数的指针，包含了函数的地址，可以通过它直接调用函数。  
2. (1) VOIDFUNCPTR  
  
本题考査嵌入式软件程序设计能力。  
函数指针是指向函数的指针变量。因此“函数指针”本身首先应是指针变量，只不过该指针变量指向函数。这正如用指针变量可指向整型变量、字符型、数组一样，这里是指向函数。如前所述，C在编译时，每一个函数都有一个入口地址，该入口地址就是函数指针所指向的地址。有了指向函数的指针变量后，可用该指针变量调用函数，就如同用指针变量可引用其他类型变量一样。函数指针有两个用途：调用函数和作为函数的参数。  
函数指针的声明方法为：  
![23910b3c38cd4209bbf5ed43f6642f24.jpg][]  
“返回值类型”说明函数的返回类型，“(指针变量名）”中的括号不能省，括号改变了运算符的优先级。若省略整体则成为一个函数说明，说明了一个返回的数据类型是指针的函数，后面的“形参列表”表示指针变量指向的函数所带的参数列表。例如：  
![5ebe44d04c5e4f489a46971f0b65d59f.jpg][]  
或者使用下面的方法将函数地址赋给函数指针：  
![7cc54b2d2587460c952044b257f9b002.jpg][]  
赋值时函数func不带括号，也不带参数，由于func代表函数的首地址，因此经过赋值以后，指针f 就指向函数func(x)的代码的首地址。  
在【C语言程序声明与定义】中，intConnect 函数的第二个参数声明为VOIDFUNCPTR 型，它是一个返回值为空的函数指针，所以在程序1的dma\_init 函数中，应该将intConnect 函数的第二个参数转换成VOIDFUNCPTR类型，可以消除编译警告。  
  
【问题2】  
(2) sem\_DMA1  
(3) sem\_DMA2  
(4) sem\_DMA1  
(5) sem\_DMA2  
  
多任务互斥是指某一资源同时只允许一个访问者对其进行访问，具有唯一性和排它性。但互斥无法限制访问者对资源的访问顺序，即访问是无序的。同步则是指在互斥的基础上（大多数情况)，通过其他机制实现访问者对资源的有序访问。在大多数情况下，同步已经实现了互斥，特别是所有写入资源的情况必定是互斥的。少数情况是指可以允许多个访问者同时访问资源。  
该程序中使用了两个信号量来实现同步与互斥机制，一个是互斥信号量sem\_DMA1,用于进行寄存器操作的临界区保护，一个是同步信号量sem\_DMA2,用于在传输函数和DMA完成中断处理程序之间同步。  
  
【问题3】  
1.2或第2行或3或第3行  
2.1或第1行  
3.2或第2行  
  
临界区指的是一个访问共用资源（例如：共用设备或是共用存储器）的程序片段，而这些共用资源又无法同时被多个线程访问的特性。当有线程进入临界区段时，其他线程或是进程必须等待，有一些同步的机制必须在临界区段的进入点与离开点实现，以确保这些共用资源是被互斥获得使用，例如：semaphore。只能被单一线程访问的设备，进程进入临界区的调度原则是：  
1.如果有若干进程要求进入空闲的临界区，一次仅允许一个进程进入。  
2.任何时候，处于临界区内的进程不可多于一个。如已有进程进入自己的临界区，则其他所有试图进入临界区的进程必须等待。  
3.进入临界区的进程要在有限时间内退出，以便其他进程能及时进入自己的临界区。  
4.如果进程不能进入自己的临界区，则应让出CPU，避免进程出现“忙等”现象。  
在程序2的dma\_trans函数中，定义了一段临界区，用互斥信号量sem\_DMA 1进行保护，佴是全局变量Dma\_err\_ret没有被保护，当该函数被多任务调用，发生重入时，由于程序缺陷破坏了临界区中Dma\_err\_ret的值，导致程序运行出错。  



[9038b891469d4d42a33dcee3c979424d.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第3题/9038b891469d4d42a33dcee3c979424d.jpg
[ca96574d6876404bb56b6634b639ac63.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第3题/ca96574d6876404bb56b6634b639ac63.jpg
[23910b3c38cd4209bbf5ed43f6642f24.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第5题/23910b3c38cd4209bbf5ed43f6642f24.jpg
[5ebe44d04c5e4f489a46971f0b65d59f.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第5题/5ebe44d04c5e4f489a46971f0b65d59f.jpg
[7cc54b2d2587460c952044b257f9b002.jpg]: https://www.xkxxkx.cn/file/exam/software/嵌入式系统设计师/案例/第5题/7cc54b2d2587460c952044b257f9b002.jpg
