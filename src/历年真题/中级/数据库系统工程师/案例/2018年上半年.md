---  
title: 2018年上半年  
# icon: gears  
order: 991  
category:  
- 历年真题  
tag:  
- 真题  
  
# navbar: false  
# sidebar: false  
  
# breadcrumb: false  
# pageInfo: false  
# contributors: false  
# editLink: false  
# lastUpdated: false  
# prev: false  
# next: false  
comment: false  
# footer: false  
  
# backtotop: false  
---  
## 第1题 ##

试题一（15分）  
阅读下列说明，回答问题1至问题4，将解答填入答题纸的对应栏内。  
【说明】  
某医疗护理机构为老年人或有护理需求者提供专业护理。现欲开发一基于Web的医疗管理系统，以改善医疗护理效率。该系统的主要功能如下：  
（1）通用信息查询。客户提交通用信息查询请求，査询通用信息表，返回查询结果。  
（2）医生聘用。医生提出应聘/辞职申请，交由主管进行聘用/解聘审批，更新医生表，并给医生反馈聘用/解聘结果；删除解聘医生的出诊安排。  
（3）预约处理。医生安排出诊时间，存入医生出诊时间表；根据客户提交的预约查询请求，查询在职医生及其出诊时间等预约所需数据并返回；创建预约，提交预约请求，在预约表中新增预约记录，更新所约医生出诊时间并给医生发送预约通知；给客户反馈预约结果。  
（4）药品管理。医生提交处方，根据药品名称从药品数据中查询相关药品库存信息，开出药品，更新对应药品的库存以及预约表中的治疗信息；给医生发送“药品已开出”反馈。  
（5）报告创建。根据主管提交的报表查询请求（报表类型和时间段），从预约数据、通用信息、药品库存数据、医生以及医生出诊时间中进行查询，生成报表返回给主管。  
现采用结构化方法对医疗管理系统进行分析与设计，获得如图1-1所示的上下文数据流图和图1-2所示的0层数据流图。  
![21eebde3d2784e43a1ae870d1055c4bf.jpg][]  
![bc98fbc8b535400bb755b6322d34a3cd.jpg][]  
  
【问题1】（3分）  
使用说明中的词语，给出图1-1中的实体E1～E3的名称。  
  
【问题2】（5分）  
使用说明中的词语，给出图1-2中的数据存储D1～D5的名称。  
  
【问题3】（4分）  
使用说明和图中术语，补充图1-2中缺失的数据流及其起点和终点。  
  
【问题4】（3分）  
使用说明中的词语，说明“预约处理”可以分解为哪些子加工？并说明建模图1-1和图1-2是如何保持数据流图平衡？  


## 第2题 ##

试题二（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
某海外代购公司，为扩展公司业务，需要开发一个信息化管理系统。请根据公司现有业务及需求完成该系统的数据库设计。  
【需求描述】  
（1）记录公司员工信息。员工信息包括工号、身份证号、姓名、性别和一个手机号，工号唯一标识每位员工，员工分为代购员和配送员。  
（2）记录采购的商品信息。商品信息包括商品名称、所在超市名称、采购价格、销售价格和商品介绍，系统内部用商品条码唯一标识每种商品。一种商品只在一家超市代购。  
（3）记录顾客信息。顾客信息包括顾客真实姓名、身份证号（清关缴税用）、一个手机号和一个收货地址，系统自动生成唯一的顾客编号  
（4）记录托运公司信息。托运公司信息包括托运公司名称、电话和地址，系统自动生成唯一的托运公司编号。  
（5）顾客登录系统之后，可以下订单购买商品。订单支付成功后，系统记录唯一的支付凭证编号。顾客需要在订单里指定运送方式：空运或海运。  
（6）代购员根据顾客的订单在超市采购对应商品，一份订单所含的多个商品可能由多名代购员从不同超市采购。  
（7）采购完的商品交由配送员根据顾客订单组合装箱，然后交给托运公司运送。托运公司按顾客订单核对商品名称和数量，然后按顾客的地址进行运送。  
【概念模型设计】  
根据需求阶段收集的信息，设计的实体联系图（不完整）如图2-1所示  
![fa4b0757d8fa4ed09fd4c09edf293a82.jpg][]  
【逻辑结构设计】  
根据概念模型设计阶段完成的实体联系图，得出如下关系模式（不完整）：  
员工（工号，身份号，姓名，性别，手机号）  
商品（条码，商品名称，所在超市名称，采购价格，销售价格，商品介绍）  
顾客（编号，姓名，身份证号，手机号，（a））  
托运公司（托运公司编号，托运公司名称，电话，地址）  
订单（订单ID，商品条码，顾客编号，（b），运送方式，支付凭证编号）  
代购（代购ID，代购员工号，订单ID，（c））  
运送（运送ID，配送员工号，托运公司编号，订单ID，发运时间）  
  
【问题1】（3分）  
根据问题描述，补充图2-1的实体联系图  
  
【问题2】（6分）  
补充逻辑结构设计结果中的（a）、（b）、（c）3处空缺。  
  
【问题3】（6分）  
为方便顾客，允许顾客在系统中保存多组收货地址。请根据此需求，增加“顾客地址”弱实体，对图2-1进行补充，并修改“运送”关系模式。  


## 第3题 ##

试题三（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
某医院为了更好的为患者服务、提高医院管理水平，拟开发满足自身特点的信息系统。其部分需求及设计如下：  
【需求描述】  
（1）患者到医院就诊，需提供本人医保卡或身份证，系统根据医保卡或身份证从外部医保信息库获取患者的其他详细信息，包括医保卡号、身份证号、姓名、性别、民族、出生日期等信息。  
（2）医生信息包括医生编号、姓名、性别、出生日期、职称等信息。  
（3）通过患者自述、化验结果分析等信息，医生对患者的病情进行诊断，开具处方，并填写病例。病例同时包含诊断和处方信息，包括编号、患者姓名、病情描述、诊断结论、主治医生、药品名称、药品数量、服用剂量等，处方中一般会有多种药品。  
（4）病人凭医生开具的处方可在医院购买药品。医院记录药品的条码、名称、价格、生产厂商等信息。  
【逻辑结构设计】  
根据上述需求，设计出如下关系模式  
医生（编号，姓名，性别，出生日期，职称）  
患者（身份证号，医保卡号，姓名，性别，民族，出生日期）  
药品（条码，名称，价格，生产厂商）  
病例（编号，药品条码，患者身份证号，主治医生编号，病情描述，诊断结论，诊断日期，服用剂量，药品数量，购买日期）  
  
【问题1】（5分）  
对关系“患者”，请回答以下问题：  
（1）给出函数依赖集。  
（2）给出所有候选码。  
（3）判定属于第几范式，并说明理由。  
  
【问题2】（7分）  
对关系“病例”，存在如下的数据依赖：  
DD＝｛编号→（患者身份证号，主治医生编号，病情描述，诊断结论，诊断日期），（编号，药品条码）→→（服用剂量，药品数量，购买日期）｝  
请回答以下问题  
（1）该关系模式存在哪些问题？  
（2）该关系模式是否属于4NF？请给出理由。  
（3）如果“病例”不是4NF，请分解，并指出分解后的关系模式所属范式。分解后的关系名依次为：病例1，病例2，...。  
  
【问题3】（3分）  
针对【问题2】的规范化要求，如果设计者分解出的多个关系模式其中之一如下：  
购药（病例编号，药品条码，服用剂量，药品数量，购买日期）  
如果医院要求统计每名医生（编号和姓名）每天接诊的患者所购买的各个药品的条码和数量。基于上述设计，实现该统计共需哪几个关系？为提高该统计效率，允许对范式条件放宽要求，请修改“购药”关系模式以优化该统计。  


## 第4题 ##

试题四（15分）  
阅读下列说明，回答问题1至问题4，将解答填入答题纸的对应栏内。  
【说明】  
某汽车租赁公司建立汽车租赁管理系统，其数据库的部分关系模式如下：  
用户： USERS(Userid，Name， Balance），各属性分别表示用户编号、姓名、余额；  
汽车：CARS(CID，Ctype，CPrice，CStatus）各属性分别表示汽车编号、型号、价格（日租金）、状态；  
租用记录： BORROWS（BRid， Userid，Cid， STime， ETime），各属性分别表示租用编号、用户编号、汽车编号、租用时间、归还时间；  
不良记录：BADS（Bid， Userid．BRid， BTime），各属性分别表示不良记录编号、用户编号、租用编号、不良记录时间。  
相关关系模式的属性及说明如下  
（1）用户租用汽车时，其用户表中的余额不能小于500，否则不能租用。  
（2）汽车状态为待租和已租，待租汽车可以被用户租用，已租汽车不能租用。  
（3）用户每租用一次汽车，向租用记录中添加一条租用记录，租用时间默认为系统当前时间，归还时间为空值，并将所租汽车状态变为已租。用户还车时，修改归还时间为系统当前时间，并将该汽车状态改为待租。要求用户不能同时租用两辆及以上汽车.  
（4）租金从租用时间起按日自动扣除.  
根据以上描述，回答下列问题，将SQL语句的空缺部分补充完整。  
  
【问题1】（4分）  
请将下面建立租用记录表的SQL语句补充完整，要求定义主码完整性约束和引用完整性约束。  
CREATE TABLE BORROWS(  
BRID CHAR(20) (a) ,  
UserId CHAR(10) (b) ,  
Cld CHAR(10) (c) ,  
STime DATETIME (d) ,  
ETime DATETIME,  
);  
  
【问题2】（4分）  
当归还时间为空值时，表示用户还未还车，系统每天调用事务程序从用户余额中自动扣除当日租金，每个事务修改一条用户记录中的余额值。由用户表上的触发器实现业务：如用户当日余额不足，不扣除当日租金，自动向不良记录表中加入一条记录，记录中的BId取值由UserId+系统当前日期构成，Btime采用GETDATE()函数取系统当前时间。补全创建触发器Bad\_TRG的SQL语句。  
CREATE TRIGGER Bad\_TRG (e) UPDATE of Balance ON USERS  
Referencing new row as nrow  
For each row  
When nrow.Balance&lt; 0  
BEGIN  
(f) ;  
//插入不良记录  
INSERT INTO BADS  
SELECT CONCAT(BORROWs. UserId, CONVERT(varchar(100),  
GETDATE(), 10)), BORROWS UserId, BRID, (g)  
// CONVERT()函数将日期型数据改为字符串型  
// CONCAT()函数实现字符串拼接  
FROM BORROWS  
WHERE (h) AND ETime IS NULL;  
END  
  
【问题3】（4分）  
不良记录是按日记录的，因此用户一次租车可能会产生多条不良记录。创建不良记录单视图BADS\_Detail，统计每次租车产生的不良记录租金费用总和大于200的记录，属性有UserId、Name、BRId、CId、Stime、Etime和total（表示未缴纳租金总和）。补全创建视图BADS\_Detail的SQL语句。  
CREATE VIEW (i) AS  
SELECT BADS. UserId, USERS. Name, BADS.BRId, CARS. Cld, Stime, Etime,  
(j) AS total  
FROM BORROWS BADS. CARS. USERS  
WHERE BORROWS.BRId=BADS. BRId  
AND BORROWS.Cid=CARS. Cld  
AND (k) =BADS. UserId  
GROUP BY BADS. UserId, USERS. Name, BADS.BRID, CARS. CId, Stime, Etime  
HAVING (l) ;  
  
【问题4】（3分）  
查询租用了型号为“A8”且不良记录次数大于等于2的用户，输出用户编号、姓名，并按用户姓名降序排序输出。  
SELECT USERS. UserId, Name  
FROM USERS，BORROWS, CARS  
WHERE USERS. UserId= BORROWS. UserId AND BORROWS.Cid= CARS. CId  
AND (m) AND EXISTS(  
SELECT \* FROM BADS  
WHERE BADS. UserId=BORROWS.UserId AND (n)  
GROUP BY UserId  
HAVING COUNT(\*)&gt;= 2)  
ORDER BY （O）；  


## 第5题 ##

试题五（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
某超市销售系统的部分关系模式如下  
商品表：Commodity（Ccode，Cname，price，qty），其中属性含义分别为：商品编号、商品名称、价格、库存量，有专门的事务保证库存量足够大，销售时无需检测。  
销售表：Sale（Sno，Ccode，amount，Stime），其中属性含义分别为：销售编号，商品编号、数量、时间。  
其销售业务规则如下：顾客在超市挑选好商品后，带商品到结算处结算付款，结算处有多名结算员使用多台机器进行结算。结算员负责扫顾客购买商品的条码和数量，由系统后台结算程序计算出顾客购买商品的总金额，修改商品表的商品库存量，并将销售信息写入销售表。  
请根据上述描述，回答以下问题。  
  
【问题1】（3分）  
假设有两个顾客同时购买同一条码的商品，结算事务修改该商品的库存量（记为数据项X）部分的调度如图5-1所示。  
![2bc991dc744d4df1806d3d710da8c900.jpg][]  
如果购买前X的初值为10，则上述调度执行完成后，X的值是多少？属于哪一类不一致性？  
  
【问题2】（6分）  
引入独占锁指令Xlock()和解锁指令Unlock()，对【问题1】中的调度进行重写，要求满足两段锁协议，且事务T1、T2首条指令的相对请求时间与【问题1】中的相同。  
  
【问题3】（6分）  
下面是用SQL实现的结算程序，请补全空缺处的代码。  
要求在保证销售信息不丢失的前提下，达到最大的系统并发度。  
CREATE PROCEDURE buy(IN: CommNo VARCHAR(20), IN: AmountBuy INT)  
BEGIN  
//输入合法性验证  
if(: AmountBuy&lt;1) return -1；  
SET TRANSACTION ISOLATION LEVEL (a) ;  
BEGIN TRANSACTION;  
//插入销售记录  
INSERT INTO Sale  
VALUES(getGUID(),: CommNo, AmountBuy, getDATETIME());  
//函数 getGUID()：获取唯一值  
//函数 getDATETIME()：获取当前系统日期时间  
if error ∥error是由DBMS提供的上一句SQL的执行状态  
BEGN  
ROLLBACK; return -2;  
END  
//修改库存数量  
UPDATE Commodity  
SET qty= (b)  
WHERE Ccode=: CommNo;  
if error  
BEGIN  
ROLLBACK; return -3;  
END  
(c)  
END  



[21eebde3d2784e43a1ae870d1055c4bf.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第1题/21eebde3d2784e43a1ae870d1055c4bf.jpg
[bc98fbc8b535400bb755b6322d34a3cd.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第1题/bc98fbc8b535400bb755b6322d34a3cd.jpg
[fa4b0757d8fa4ed09fd4c09edf293a82.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第2题/fa4b0757d8fa4ed09fd4c09edf293a82.jpg
[2bc991dc744d4df1806d3d710da8c900.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第5题/2bc991dc744d4df1806d3d710da8c900.jpg
