---  
title: 2019年上半年  
# icon: gears  
order: 990  
category:  
- 历年真题  
tag:  
- 真题  
  
# navbar: false  
# sidebar: false  
  
# breadcrumb: false  
# pageInfo: false  
# contributors: false  
# editLink: false  
# lastUpdated: false  
# prev: false  
# next: false  
comment: false  
# footer: false  
  
# backtotop: false  
---  
## 第1题 ##

试题一（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
学校欲开发一学生跟踪系统，以更自动化、更全面地对学生在校情况（到课情况和健康状态等相关信息）进行管理和追踪，使家长能及时了解子女的到课情况和健康状态，并在有健康问题时及时与医护机构对接。该系统的主要功能是：  
（1）采集学生状态。通过学生卡传感器，采集学生心率、体温（摄氏度）等健康指标及其所在位置等信息并记录。每张学生卡有唯一的标识（ID）与一个学生对应。  
（2）健康状态告警。在学生健康状态出现向题时，系统向班主任、家长和医护机构健康服务系统发出健康状态警告，由医护机构健康服务系统通知相关医生进行处理。  
（3）到课检查。综合比对学生状态、课表以及所处校园场所之间的信息对学生到课情况进行判定。对旷课学生，向其家长和班主任发送旷课警告。  
（4）在校情况汇总。定期汇总在校情况，并将报告发送给家长和班主任。  
（5）家长注册。家长注册使用该系统，指定自己子女，经学校管理人员审核后，向家长发送注册结果。  
（6）基础信息管理。学校管理人员对学生及其所用学生卡和班主任、课表（班级、上课时间及场所等）、校园场所（名称和所在位置区域）等基础信息进行管理，对家长注册申请进行审核，将家长ID加入学生信息记录中使家长与其子女进行关联，一个学生至少有一个家长，可以有多个家长。课表信息包括班级、班主任、时间和位置等。  
现采用结构化方法对学生跟踪系统进行分析与设计，获得如图1-1所示的上下文数据流图和图1-2所示的0层数据流图。  
![adaf43ceb7bc4fce84512dda50796d88.jpg][]  
![1ab86682fafb48a1afe67b9f276e6954.jpg][]  
  
【问题1】（5分）  
使用说明中的词语，给出图1-1中的实体E1~E5的名称。  
  
【问题2】（4分）  
使用说明中的词语，给出图1-2中的数据存储D1~D4的名称。  
  
【问题3】（3分）  
根据说明和图中术语，补充图1-2中缺失的数据流及其起点和终点（三条即可）。  
  
【问题4】（3分）  
根据说明中术语，说明图1-1中数据流“学生状态”和“学生信息”的组成。  


## 第2题 ##

试题二（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
某创业孵化基地管理若干孵化公司和创业公司，为规范管理创业项目投资业务，需要开发一个信息系统。请根据下述需求描述完成该系统的数据库设计。  
【需求描述】  
（1）记录孵化公司和创业公司的信息。孵化公司信息包括公司代码、公司名称、法人代表名称、注册地址和一个电话；创业公司信息包括公司代码、公司名称和一个电话。孵化公司和创业公司的公司代码编码不同。  
（2）统一管理孵化公司和创业公司的员工。员工信息包括工号、身份证号、姓名、性别、所属公司代码和一个手机号，工号唯一只每位员工。  
（3）记录投资方信息，投资方信息包括投资方编号、投资方名称和一个电话。  
（4）投资方和创业公司之间依靠孵化公司牵线建立创业项目合作关系，具体实施由孵化公司的一位员工负责协调投资方和创业公司的一个创业项目。一个创业项目只属于一个创业公司，但可以接受若干投资方的投资。创业项目信息包括项目编号、创业公司代码、 投资方编号和孵化公司员工工号。  
【概念模型设计】  
根据需求阶段收集的信息，设计的实体联系图（不完整）如图2-1所示。  
![8d5b9ce1cda54b0c8c0cb7e3a92aeaef.jpg][]  
【逻辑结构设计】  
根据概念模型设计阶段完成的实体联系图，得出如下关系模式（不完整）: 孵化公司（公司代码,公司名称，法人代表名称，注册地址，电话）  
创业公司（公司代码，公司名称，电话）  
员工（工量，身份证号，姓名，性别，（a），手机号）  
投资方（投资方编号、投资方名称，电话）  
项目（项目编号,创业公司代码，（b），孵化公司员工工号）  
  
【问题1】（5分）  
根据问题描述，补充图2-1的实体联系图。  
  
【问题2】（4分）  
补充逻辑结构设计结果中的（a）、（b）两处空缺及完整性约束关系。  
  
【问题3】（6分）  
若创业项目的信息还需要包括投资额和投资时间，那么：  
（1）是否需要增加新的实体来存储投资额和投资时间？  
（2）如果增加新的实体，请给出新实体的关系模式，并对图2-1进行补充。如果不需要增加新的实体，请将“投资额”和“投资时间”两个属性补充并连线到图2-1合适的对象上，并对变化的关系模式进行修改。  


## 第3题 ##

试题三（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
某快递公司对每个发出的快递进行跟踪管理，需要建立一个快递跟踪管理系统，对该公司承接的快递业务进行有效管理。  
【需求描述】  
1.公司在每个城市的每个街道都设有快递站点。这些站点负责快递的接收和投递。站点信息包括站点地址、站点名称、责任人、一部联系电话、开始营业时间、结束营业时间。每个站点每天的营业时间相同。每个站点只能有一个责任人。  
2.系统内需记录快递员、发件人的基本信息。这些信息包括姓名、身份证号、一个联系地址、一部联系电话。快递站点的责任人由快递员兼任，且每个快递站点只有一个责任人。每个快递员只负责一个快递站点的揽件和快递派送业务。发件人和快递员需实名认证。  
3.快递需要提供详实的信息，包括发件人姓名、身份证号、一部发件人电话号码、发件人地址、收件站点、收件人姓名、收件地址、一部收件人电话、投递时间、物品类别、物品名称及物品价值。每个发件人和收件人在系统里只能登记一个电话和地址。  
4.每个快递员接手一份快递后，需在系统中录入每个快递的当前状态信息，包括当前位置、收到时间、当前快递员和上一段快递员。状态信息包括待揽件、投递中、已签收。如果快递已签收，应记录签收人姓名及一个联系电话。每个快递在一个站点只能对应一个负责的快递员。  
注：试题不需要考虑快递退回的相关问题。  
【逻辑结构设计】  
根据上诉需求需求，设计出如下关系模式：  
快递（快递编号，收件人姓名，收件地址编号，收件人电话，投递时间，物品类别，物品名称，物品价值），其中收件地址编号是地址实体的地址编号。  
快递员（姓名，身份证号,电话号码，联系地址编号，工作站点编号）  
快递站点（站点编号，站点名称，责任人编号，站点地址编号，开始营业时间，联系电话，结束营业时间）。责任人编号是负责该站点的快递员的身份证号。  
地址（地址编号，所在省，所在市，所在街道，其他），其他信息是需补充的地址信息。  
快递投递（快递编号，快递员编号，发件人姓名，发件人身份证号，发件人电话号码，发件人地址编号），其中发件人地址编号为发件人地址的地址编号，揽件站点编号为接收该快递的站点编号。  
快递跟踪（快递编号，当前快递员编号，上一段快递员编号，当前状态，收到时间，当前站点编号）。  
快递签收（快递编号,签收人姓名，签收人联系电话）。  
  
【问题1】（6分）  
对关系“快递投递”，请回答以下问题：  
(1) 列举出所有候选键。  
(2) 它是否为3NF,用100字以内文字简要叙述理由。  
(3) 将其分解为BCNF,分解后的关系名依次为：快递投递1,快递投递2，…，并用下划线标示分解后各关系模式的主键。  
  
【问题2】（6分）  
对关系“快递跟踪”，请回答以下问题：  
(1) 列举出所有候选键。  
(2) 它是否为2NF，用100字以内文字简要叙述理由。  
(3) 将其分解为BCNF，分解后的关系名依次为：快递跟踪1，快递跟踪2，…，并用下划线标示分解后各关系模式的主键。  
  
【问题3】（3分）  
快递公司会根据快递物品和距离收取快递费，每件快递需由发件人或收件人支付快递费给公司。同一个发件人同时发起多个快递，必须分别支付。快递公司提供预支付和到付两种支付方式。为了统计快递费的支付情况(详细金额和时间)，试增加“快递费支付”关系模式，用100字以内文字简要叙述解决方案。  


## 第4题 ##

试题四（15分）  
阅读下列说明，回答问题1至问题4，将解答填入答题纸的对应栏内。  
【说明】  
某学生信息管理系统的部分数据库关系模式如下：  
学生：Student ( stuno, stuname, stuage, stusex, schno),各属性分别表示学生的学号、姓名、年龄、性别，以及学生所属学院的编号；  
学院：School ( schno， schname, schstunum ),各属性分别表示学院的编号、名称及学生人数；  
俱乐部：Club (clubno,clubname, clubyear, clubloc ),各属性分别表示俱乐部的编号、名称、成立年份和活动地点；  
参加：JoinClub ( stuno, clubno. joinyear ),各属性分别表示学号、俱乐部编号，以及学生加入俱乐部的年份。  
有关关系模式的说明如下：  
(1) 学生的性别取值为‘F’和‘M' (F表示女性，M表示男性)。  
(2) 删除一个学院的记录时，通过外键约束级联删除该学院的所有学生记录。  
(3) 学院表中的学生人数值与学生表中的实际人数要完全保持一致。也就是说，当学生表中增减记录时，就要自动修改相应学院的人数。  
  
【问题1】（4分）  
请将下面创建学生表的SQL语句补充完整，要求定义实体完整性约束、参照完整性约束，以及其他完整性约束。  
CREATE TABLE Student (  
stuno CHAR(11) （ ），  
stuname VARCHAR（ ）,  
stuage SMALLINT,  
stusex CHAR(1) （ ），  
schno CHAR(3) （ ） ON DELETE （ ）)；  
  
【问题2】（5分）  
创建倶乐部人数视图，能统计每个倶乐部已加入学生的人数，属性有clubno&gt; clubname 和clubstunum。对于暂时没有学生参加的俱乐部，其人数为0。此视图的创建语句如下，请补全。  
CREATE VIEW CS\_NUMBER ( clubno, clubname, clubstunum ) AS  
SELECT JoinClub.clubno, （ ） , （ ）  
FROM JoinClub, Club  
WHERE JoinClub.clubno = Club.clubno  
（ ） BY JoinClub.clubno （ ）  
SELECT clubno, clubname, 0 FROM Club  
WHERE clubno NOT 04  
(SELECT DISTINCT clubno FROM （ ）);  
  
【问题3】（4分）  
每当系统中新加或删除一个学生，就需要自动修改相应学院的人数，以便保持系统中学生人数的完整性与一致性。此功能由下面的触发器实现，请补全。  
CREATE TRIGGER STU\_NUM\_TRG  
AFTER INSERT OR DELETE ON （ ）  
REFERENCING new row AS nrow, old row AS orow FOR EACH（ ）  
BEGIN  
IF INSERTING THEN  
UPDATE School （ ）  
END IF;  
IF DELETING THEN  
UPDATE School （ ）;  
END IF;  
END;  
  
【问题4】（2分）  
查询年龄小于19岁的学生的学号、姓名及所属学院名，要求输出结果把同一个学院的学生排在一起。此功能由下面的SQL语句实现，请补全。  
SELECT stuno, stuname, schname FROM Student, School WHERE Student.schno = School.schno  
AND stuage &lt;19 （ ） BY （ ）;  


## 第5题 ##

试题五（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
某商业银行账务系统的部分关系模式如下：  
账户表：Account (ano, aname, balance)，其中属性含义分别为：账户号码，账户名称和账户余额。  
交易明细表：TranDetails (too, ano, ttime, toptr, amount, ttype),其中属性分别为：交易编号，账户号码，交易时间，交易操作员，交易金额，交易类型(1-存款，2-取款，3-转账)。  
余额汇总表：AcctSums (adate, atime, allamt),其中属性分别为：汇总日期，汇总时间，总余额。  
常见的交易规则如下：  
存/取款交易：操作员核对用户相关信息，在系统上执行存/取款交易。账务系统増加/ 减少该账户余额/并在交易明细表中增加一条存/取款交易明细。  
转账交易：操作员核对用户相关信息，核对转账交易账户信息，在系统上执行转账交易。账务系统对转出账户减少其账户余额，对转入账户增加其账户余额，并在交易明细表中增加一条转账交易明细。  
余额汇总交易：将账户表中所有账户余额累计汇总。  
假定当前账户表中的数据记录如表5-1所示。  
![2271991ecf6a437ebedadce0ebc9e12f.jpg][]  
  
【问题1】（3分）  
假设在正常交易时间，账户上在进行相应存取款或转账操作时，要执行余额汇总交易。下面是用SQL实现的余额汇总程序，请补全空缺处的代码。要求(不考虑并发性能)在 保证余额汇总交易正确性的前提下，不能影响其他存取款或转账交易的正确性。  
CREATE PROCEDURE AcctSum(OUT： Amts DOUBLE)  
BEGIN  
SET TRANSACTION ISOLATION LEVEL（ ）;  
BEGIN TRANSACTION;  
SELECT sum(balance) INTO : Amts FROM Accounts;  
if error// error是由DBMS提供的上一句SQL的执行状态  
BEGIN  
ROLLBACK;  
return -2;  
END  
INSERT INTO AcctSums  
VALUES (getDATE(), getTIME(), （ ）);  
if error // error是由DBMS提供的上一句SQL的执行状态  
BEGIN  
ROLLBACK;  
return-3;  
END  
（ ）;  
END  
  
【问题2】（8分）  
引入排它锁指令LX()和解锁指令UX(),要求满足两段锁协议和提交读隔离级别。假设在进行余额汇总交易的同时，发生了一笔转账交易。从101账户转给104账户400元。 这两笔事务的调度如表5-2所示。  
![b5015e58b6c64d258786a9d036f784c4.jpg][]  
(1)请补全表中的空缺处(a)、(b);  
(2)上述调度结束后，汇总得到的总余额是多少？  
(3)该数据是否正确？请说明原因。  
  
【问题3】（4分）  
在【问题2】的基础上，引入共享锁指令LS0和解锁指令US()。对【问题2】中的调度进行重写，要求满足两段锁协议。两个事务执行的某种调度顺序如表5-3所示，.该调度顺序使得汇总事务和转账事务形成死锁。请补全表中的空缺处(a)、(b)。  
![80c57a8602d2487bbd32cf0d4f0d62cb.jpg][]  
  


## 答案及解析 ##

  



[adaf43ceb7bc4fce84512dda50796d88.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第1题/adaf43ceb7bc4fce84512dda50796d88.jpg
[1ab86682fafb48a1afe67b9f276e6954.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第1题/1ab86682fafb48a1afe67b9f276e6954.jpg
[8d5b9ce1cda54b0c8c0cb7e3a92aeaef.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第2题/8d5b9ce1cda54b0c8c0cb7e3a92aeaef.jpg
[2271991ecf6a437ebedadce0ebc9e12f.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第5题/2271991ecf6a437ebedadce0ebc9e12f.jpg
[b5015e58b6c64d258786a9d036f784c4.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第5题/b5015e58b6c64d258786a9d036f784c4.jpg
[80c57a8602d2487bbd32cf0d4f0d62cb.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第5题/80c57a8602d2487bbd32cf0d4f0d62cb.jpg
## 第1题 ##

【问题1】  
E1:学生卡  
E2:管理人员  
E3:班主任  
E4:家长  
E5:医护机构健康服务系统  
  
本题考查采用结构化方法进行软件系统的分析与设计，主要考查利用数据流图(DFD)进行分析和建模。  
DFD是面向数据流建模的工具，它将系统建模成输入、加工（处理)、输出的模型，即流入软件的数据对象、经由加工的转换、最后以结果数据对象的形式流出软件，并采用自顶向下分层建模进行逐层细化。顶层DFD(上下文数据流图）建模用于确定系统边界以及系统的输入输出数据，待开发软件系统被看作一个加工，为系统提供输入数据以及接受系统输出数据的是外部实体，外部实体和加工之间的输入输出即为数据流。数据流或者由具体的数据属性（也称为数据结构）构成，或者由其他数据流构成，即组合数据流，用于在高层数据流图中组合相似的数据流。将上下文DFD中的加工分解成多个加工，分别识别这些加工的输入数据流以及经过加工变换后的输出数据流，建模0层DFD。根据0层DFD中加工的复杂程度进一步建模加工的内容。根据需求情况可以将数据存储建模在不同层次的DFD中。  
在建模分层DFD时，需要注意加工和数据流的正确使用，一个加工必须既有输入又有输出；数据流须和加工相关，即数据流至少有一头为加工；要注意在绘制下层数据流图时保持父图与子图平衡，即父图中某加工的输入输出数据流必须与其子图的输入输出数据流在数量和名字上相同，或者父图中的一个输入（或输出）数据流对应于子图中几个输入（或输出）数据流的组合数据流。  
题目题干描述清晰，易于分析，要求考生细心分析题目说明中所描述的内容。  
本问题考查上下文DFD，要求确定外部实体。在上下文DFD中，待开发系统名称“学生跟踪系统”作为唯一加工的名称，为这一加工提供输入数据流或者接收其输出数据流的外部实体，涉及学生卡、班主任、家长、医护机构健康服务系统和管理人员。需要注意的是，医生并不直接接收学生跟踪系统的信息，说明（2）中“由医护机构健康服务系统通知相关医生”是本系统的外部实体医护机构健康服务系统在本系统之外与医生之间进行的交互，所以在给定的业务背景的情况下，医生不属于本系统的外部实体。再根据描述相关信息进行对应，对照图1-1，即可确定E1为“学生卡”实体，E2为“管理人员”实体，E3为“班主任”实体，E4为“家长”，E5为“医护机构健康服务系统”。  
  
【问题2】  
D1:学生状态  
D2:学生  
D3:校园场所  
D4:课表  
  
本问题要求确定图1-2中0层数据流图中的数据存储。重点分析说明中与数据存储有关的描述。说明（1）中“采集学生状态”“并记录”，图1-2中从加工“采集学生状态”流入D1的数据流明确了 “学生状态”，可知D1为“学生状态”；再由说明（6）中“基础信息管理”的描述信息，结合图1-2中P6流入D2的“学生基础信息”、流入D3的“校园场所”、流入D4的“课表信息”和从D2流出的“学生信息”等，可知D2为“学生”、D3为“校园场所”、D4为“课表”。  
  
【问题3】  
![2678e885ff4f4041b5f9da1a426379ea.jpg][]  
  
本问题要求补充缺失的数据流及其起点和终点。对照图1-1和图1-2的输入、输出数据流，没有缺少与外部实体之间的数据流。  
再考査题干中的说明判定是否缺失内部的数据流，不难发现图1-2中缺失的数据流。加工P3到课检查需要综合课表信息、校园场所，所以，有从D4课表流向P3到课检查的数据流“课表信息”、从D3校园场所流向P3到课检查的“场所信息”以及从D5家长流向P3到课检查的“家长信息”。加工P4汇总在校情况需要综合学生信息、课表信息、场所信息和学生状态信息，需要从学生信息中获取家长ID，根据家长ID获取家长信息，并将报告发送给家长和班主任，所以，流向P4汇总在校的数据流缺少从D4课表流入的“课表信息”、从D3校园场所流入的“场所信息”和D5家长流入的“家长信息”。再由说明（6）中“对家长注册申请进行审核”“将家长ID加入学生信息记录中使家长与其子女进行关联”不难发现，有从P6基础信息维护流入D2学生的数据流“家长ID”;从P5家长注册流入的“家长注册申请”。  
  
【问题4】  
学生状态=学生卡ID+心率+体温+位置+时间   
学生信息=学生ID+学生卡ID+1\{家长ID\}\*+班主任ID+班级  
  
数据流由具体的数据属性构成采用符号加以表示，“=”表示组成（被定义为)，“+”表示有多个属性（与），\{\}表示其中属性出现多次，()表示其中属性可选等。图1-1中的“学生状态”来自于E1学生卡，“学生信息”从D2数据存储流出。在说明（1）中给出“采集学生心率、体温（摄氏度）等健康指标及其所在位置等”以及“每张学生卡有唯一的标识（ID)与一个学生对应”；说明（6）中给出说明“对学生及其所用学生卡和班主任”“将家长ID加入学生信息记录中”等信息。然后采用“=”和“+”将数据流及其属性表示出来。需要注意的是，“一个学生至少有一个家长，可以有多个家长”说明一条学生信息中可以有一到多个家长信息，在数据流表示中需要使用\{\}，即“1\{家长ID\}\*”。  


## 第2题 ##

【问题1】  
![a3608ab0319e42d3af84ad488e68b986.jpg][]  
  
本题考查数据库概念结构设计及逻辑结构转换的掌握。此类题目要求考生认真阅读题目，根据题目的需求描述，给出实体间的联系。  
根据题意由“投资方和创业公司之间依靠孵化公司牵线建立创业项目合作关系，具体实施由孵化公司的二位员工负责协调投资方和创业公司的一个创业项目。”可知投资方、创业公司和员工三方参与项目联系，三方之间为1:\*:1联系。根据题意由“统一管理孵化公司和创业公司的员工。”可知创业公司和员工之间为1:\*联系。  
  
【问题2】  
(a)公司代码   
(b)投资方编号  
  
根据需求描述（2）可知员工信息包含工号、身份证号、姓名、性别、所属公司代码和一个手机号。所以在员工关系里应该包括“公司代码”，且以外键标识。  
根据需求描述（4）可知投资方、创业公司和员工三方之间为1:\*:1联系，所以需要在项目关系模式中包含“投资方编号”，且以外键标识。  
  
【问题3】  
（1）不需要  
（2）![9e0ea509816d486c9297989b2746ebe6.jpg][]  
关系模式:项目(项目编号，创业公司代码，投资方编号，孵化公司员工工号，投资额，投资时间)  


## 第3题 ##

【问题1】  
对关系“快递投递”。  
(1)候选键：快递编号。  
(2)不是3NF。存在非主属性“发件人姓名”对候选键“快递编号”的传递依赖： 快递编号→发件人身份证号，发件人身份证号→发件人姓名。所以快递编号→发件人姓名，为传递依赖。所以，“快递投递”关系模式不满足第三范式。  
(3)分解后的关系模式：  
快递投递1(快递编号，快递员编号，发件人身份证号）。  
快递投递2(发件人姓名，发件人身份证号，发件人电话号码，发件人地址编号）  
  
本题考查数据库范式概念的理解及应用。  
此类题目要求考生认真阅读题目对现实问题的描述，经过分析找出关系模式的侯选键、主键，并且可以分析出关系模式所属范式类别。最后要求考生根据实际需求自行设计出符合实际需求的关系模式。  
对关系“快递投递”进行分析，关系模式如下：  
快递投递（快递编号，快递员编号，发件人姓名，发件人身份证号，发件人电话号码，发件人地址编号）  
(1)其中快递编号可以唯一标识一个快递投递元组，故为候选键。  
(2)第三范式（Third Normal Form,3rdNF)就是指表中的所有数据元素不但要能唯一地被主键所标识，它们之间还必须相互独立，不存在其他的函数依赖关系。而快递投递关系中，快递编号→发件人身份证号，发件人身份证号→发件人姓名，明显存在传递依赖关系，故不是第三范式。  
(3)在3NF的基础上消除主属性对于码的部分函数依赖及传递函数依赖。而实际上将原关系模式改写成3NF之后不存在主属性对于码的部分与传递函数依赖，故改写成3NF之后便满足了BCNF的要求。  
  
【问题2】  
对关系“快递跟踪”：  
(1)候选键:（快递编号，当前负责人编号）。  
(2)不是2NF。候选键（快递编号，当前负责人编号）部分决定非主属性“当前站点编号”。  
(3)分解后的关系模式：  
快递跟踪1(快递编号，当前负责人编号，前一负责人编号，当前状态，收到时间）。“当前站点编号”已在站点信息中出现，并可以通过当前负责人编号查询，无需再用关系模式处理。  
  
对关系“快递跟踪”进行分析，关系模式如下：  
快递跟踪（快递编号，当前负责人编号，前一负责人编号，当前状态，收到时间，当前站点编号）。  
(1)该关系模式中需要快递编号和当前负责人编号两项共同决定一个快递跟踪元组，故候选键为（快递编号，当前负责人编号）。  
(2)2NF要求不能有非主属性对于码的部分函数依赖，但是当前负责人编号可唯一标识当前站点编号，存在部分函数依赖当前负责人编号—当前站点编号，故不是2NF。  
(3)“当前站点编号”不需要通过该关系模式处理，可以通过负责人编号查询，故在该关系模式中将该项删掉即可。  
  
【问题3】  
因为需要针对每个快递，统计支付的金额、时间及支付方式，所以在增加的“快递收费”关系模式中需要体现快递编号、金额、支付时间和支付方式，即增加的关系模式为：  
快递费支付(快递编号,金额,支付时间,支付方式）。  
  
本题意在考査考生自主设计关系模式的能力。因为要计量快递的费用，故需要将与费用相关的属性加到该关系模式中，如支付时间、支付方式及金额等。  


## 第4题 ##

【问题1】  
(a)PRIMARY KEY  
(b)CHECK(stusex IN(‘F’,‘M’))  
(c)REFERENCES School (schno)  
(d)CASCADE  
  
本题考査SQL编程应用。  
本问题考查SQL的数据定义和完整性约束。  
根据题目描述，在学生表Student中，学号stuno为主键；学院编号schno为外键， 参照学院表School的schno,要求级联删除。另外，性别stusex的取值限定为‘F’和‘M’。 因此创建学生表的完整SQL语句为：  
![85838a7baae949fbb10e02fba33654c4.jpg][]  
  
【问题2】  
(e)MIN(clubname),或者MAX(clubname)  
(f)COUNT(stuno),或者COUNT(\*)  
(g)GROUP  
(h)UNION  
(i)JoinClub   
  
本问题考查SQL创建视图及查询操作。  
题目要求创建统计俱乐部学生人数的视图，其属性有dubno、dubname和clubstunum。俱乐部人数的统计分为两类，一类是己经有学生参加的俱乐部，其人数需要统计；另一类是暂时没有学生参加的俱乐部，其人数为0。两类结果最后要用UNION合并起来。  
对于己经有学生参加的俱乐部，在表JoinClub中按clubno分组统计stuno的个数得到人数。这里为了输出clubname，需要进行JoinClub和Club的连接；clubname不能直接输出因为它不是分组属性，但由于在同一分组里clubname的值相同，因此可以对其作用聚集函数MIN或MAX后输出clubname的值。  
对于暂时没有学生参加的倶乐部，从表Club中选出clubno没有出现在表JoinClub中的相关信息即可。  
因此完整创建视图CS\_NUMBER的SQL语句如下：  
![c7cd71347116464a93becb3f0558c446.jpg][]  
  
【问题3】  
(j)Student  
(k)ROW  
(1)SET schstunum=schstunum+1 WHERE schno=nrow.schno  
(m)SET schstunum=schstunum-1 WHERE schno=orow.schno  
  
本问题考查触发器的设计。  
根据题意，School表中由属性schstunum记录每个学院的人数，此属性的值必须与Student表中相应学院的学生记录数保持一致。为此，每当给Student表中插入一条记录时，就要把schstunum的值加1;每当删除Student表中的一条记录时，就要把schstunum的值减1。这样的功能由触发器来实现，其完整创建语句如下：  
![ae9290660c4640d49a56f63c3cfa0eec.jpg][]  
  
【问题4】  
(n)ORDER  
(o)schname,或者schname ASC,或者schname DESC  
  
本问题考查SQL查询操作。  
题目要求查询年龄小于19岁的学生的学号、姓名及所属学院名，并把同一个学院的学生排在一起。要完成此功能，输出结果需要按照学院名进行排序，升序或降序皆可。完整的查询语句如下：  
  
![8a184b5900fa44af9212e9bc4e1d6841.jpg][]  


## 第5题 ##

【问题1】  
(a)SERIALIZABLE; (b):Amts； (c)COMMIT 本题考查数据库中存储过程和事务并发的基本概念。 本问题考查数据库存储过程和事务隔离的基本概念。 由于数据库总是被很多用户所共享，在数据库并发操作中，往往会出现数据的更新丢失、脏读、不可重复等问题。为了避免出现上面这三种情况，在标准SQL规范中，定义了4个事务隔离级别，不同的隔离级别对事务的处理不同：未提交读、提交读、可重复读取、串行化，其中串行化隔离级别提供严格的事务隔离。它要求事务序列化执行，事务只能一个接着一个地执行，不能并发执行。隔离级别越高，越能保证数据的完整性和一致性，但是对并发性能的影响也越大。 根据问题1的题干描述和己给出的程序语句，可以看出该程序语句需要实现余额汇总事务的串行化操作，从而保证余额汇总交易数据正确性的前提下，不影响其他交易的正确性。 因此空白（a）处应该填写SEFUALIZABLE，表示当前事务设置为串行化隔离级别；空白（b）处应填写宿主变量：Amts,表示汇总余额；空白（c）处应填写COMMIT,表示事务正确结束时的提交操作。  
  
【问题2】  
(1)(a)阻塞；  
(b)UX(101),UX(104),提交；  
(2)汇总余额为2000;  
(3)该数据不正确（错误）。  
原因：提交读隔离级别下，当释放锁并提交修改后，汇总交易读到的数据不是104账户原来的数据200元，而是修改后的数据600元，转账的400元被重复计算了两次。  
  
本问题考查两段锁协议和排它锁的基本概念及应用。  
两段锁协议是指每个事务的执行可以分为两个阶段：生长阶段（加锁阶段）和衰退阶段（解锁阶段具体要求是：在对任何数据进行读、写操作之前，要申请并获得对该数据的封锁；每个事务中，所有的封锁请求先于所有的解锁请求。  
排它锁又称为写锁，若事务T对数据对象A加上写锁，则只允许T读取和修改A，其他任何事务都不能再对A加任何类型的锁，直到T释放A上的锁它防止任何其他事务获取资源上的锁，直到在事务的末尾将资源上的原始锁释放为止。  
根据题干描述，汇总事务和转账事务并发执行。在T6时刻，汇总事务读取104账户余额，但由于在T5时刻，转账交易已经对104账户加了排它锁，所以汇总事务读取104账户余额的操作被阻塞。在T7时刻，转账事务执行完毕，释放104和101账户上的排它锁，并提交事务。  
T8时刻，汇总事务得到异步通知后继续执行，注意，此时转账交易己经成功提交，根据提交读隔离级别的定义，104账户的余额己经由原来的200变为600。因此当汇总事务执行结束后，汇总得到的总余额是：500+350+550+600=2000，而不是正确的500+350+550+200=1600。  
该数据错误。提交读隔离级别下，当释放锁并提交修改后，汇总交易读到的数据不是104账户原来的数据200元，而是修改后的数据600元，转账的400元被重复计算了两次。  
  
【问题3】  
(a)LX(104)，更新104账户余额；  
(b)LX(101)，更新101账户余额。  
  
本问题考查死锁的基本概念及应用。  
死锁是指两个或两个以上的事务在执行过程中，由于竞争资源而造成的一种阻塞的现象。在满足两段锁协议和提交读隔离级别的前提下，同时支持排它锁和共享锁的情况下，造成死锁的前提条件是两个事务对两个共享数据形成了交叉锁定，必然造成死锁。  
根据题干描述和分析死锁的形成条件,汇总事务和转账事务的共享数据是101和104账户，在T2时刻，汇总事务已经为101账户加了共享锁，因此（a）处应该为账户104加排它锁，并更新104账户余额。在（b）处，应该为账户101加排它锁，并更新101账户余额。  



[2678e885ff4f4041b5f9da1a426379ea.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第1题/2678e885ff4f4041b5f9da1a426379ea.jpg
[a3608ab0319e42d3af84ad488e68b986.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第2题/a3608ab0319e42d3af84ad488e68b986.jpg
[9e0ea509816d486c9297989b2746ebe6.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第2题/9e0ea509816d486c9297989b2746ebe6.jpg
[85838a7baae949fbb10e02fba33654c4.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第4题/85838a7baae949fbb10e02fba33654c4.jpg
[c7cd71347116464a93becb3f0558c446.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第4题/c7cd71347116464a93becb3f0558c446.jpg
[ae9290660c4640d49a56f63c3cfa0eec.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第4题/ae9290660c4640d49a56f63c3cfa0eec.jpg
[8a184b5900fa44af9212e9bc4e1d6841.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第4题/8a184b5900fa44af9212e9bc4e1d6841.jpg
