---  
title: 2021年上半年  
# icon: gears  
order: 988  
category:  
- 历年真题  
tag:  
- 真题  
  
# navbar: false  
# sidebar: false  
  
# breadcrumb: false  
# pageInfo: false  
# contributors: false  
# editLink: false  
# lastUpdated: false  
# prev: false  
# next: false  
comment: false  
# footer: false  
  
# backtotop: false  
---  
## 第1题 ##

【问题1】  
![9911b3d09e02423c97927542d8dfad43.jpg][]  
  
根据题干中对订单信息的描述，需要记录客户订单信息，包括订单编号、团购点编号、客户电话、订单内容和日期，其中包括了团购点编号，客户电话，所以订单表与社区团购点关系和客户关系有联系，并且团购和客户的联系的多种度为\*:\*。  
  
  
【问题2】  
（a）：团购点编号。主键为：（供货商编号，团购点编号），外键为：供货商编号，团购点编号。  
（b）：客户电话。主键为：订单编号，外键为：团购点编号，客户电话。  
  
根据图1-1的实体联系图，可以得知供应商和团购的关系是多对多，所以供货联系需要转化为单独的表，属性取多方的码以及自有的属性。  
  
【问题3】  
![959b1653c1c141fbb9cd13fbef4e19ea.jpg][]  
  
根据题干的描述，若社区蔬菜团购网站还兼有代收快递的业务，请增加新的“快递”实体，并给出客户实体和快递实体之间的“收取’联系。“快递”关系模式包括快递编号、客户电话和日期。需要增加收取联系和快递关系，并且快递关系包括了属性快递编号、客户电话和日期，其中快递编号为主键。  


## 第2题 ##

【问题1】  
左侧只有一个属性的函数依赖关系有2个，分别为：  
车牌号-&gt;行驶路线  
消毒人员工号-&gt;消毒人员姓名  
不满足2NF，根据题干可以得到消毒记录表的候选键为（日期，车牌号），由于存在车牌号-&gt;行驶路线，属于部分依赖。根据2NF的要求，不存在非主数据对主属性的部分依赖，所以不满足2NF。  
  
【问题2】  
由于消毒记录表不满足2NF，需要将消毒记录表进行拆分成多个表，拆分的表如下：  
消毒记录1（车牌号，行驶路线）  
消毒记录2（消毒人员工号，消毒人员姓名）  
消毒记录3（车牌号，日期，消毒人员工号）  
由于拆分后的三个表都不存在非主属性对主属性的部分和传递函数依赖，所以都满足3NF。  
  
【问题3】  
如上修改问题2中的 消毒记录3(日期，消毒时间，车牌号,消毒人员工号) 新关系中，如果在同一时间段消毒人员只能给一辆车消毒的话，这存在两个候选码: (日期,消毒时间，车牌号)和(日期，消毒时间，消毒人员工号)由于没有非主属性，则自然达到3NF。  


## 第3题 ##

【问题1】  
（a）：PLAYER  
（b）：CONTEST  
（c）：NOT NULL  
（d）：CHECK(Rank in(’一’, ’二’, ’三’, ’无’))  
（e）：PRIMARY KEY (Pno,Cno)  
  
CREATE PROCEDURE UpdateBookSale（in bno varchar（20））  
Declare  
all\_nums number(6);  
SELECT SUM(book\_numbs) into all\_nums from orders  
Where book\_no=bno;  
IF all\_nums &lt; 10000 then Update books set sale\_type=0 where book\_no=bno; Else Update books set sale\_type=1 where book\_no=bno; end if commit; end  
  
【问题2】  
f: PLAYER  
g: not in  
h: pno  
i: pc.cno=contest.cno  
j: and  
k: order by  
  
SELECT Pno FROM PLAYER  
WHERE Pno not in (  
SELECT pno FROM PC, Contest  
WHER pc.cno=contest.cno  
and Type='Al' )  
order by Pon;  
  
【问题3】  
l：delete  
m：PC  
n：delete  
o：CONTEST  
  
请注意删除表中的数据，根据外键约束，先要删除子表中的数据，再删除主表的数据。  
DELETE FROM PC WHERE Cno= ‘E06’;  
DELETE FROM CONTEST WHERE Cno='E06’;  


## 第4题 ##

【问题1】  
a: sum  
b:bno  
c:10000  
d:1  
e:commit  
  
CREATE PROCEDURE UpdateBookSale（in bno varchar（20））  
Declare  
all\_nums number(6);  
SELECT SUM(book\_numbs) into all\_nums from orders  
Where book\_no=bno;  
IF all\_nums &lt; 10000 then  
Update books set sale\_type=0 where book\_no=bno;  
Else  
Update books set sale\_type=1 where book\_no=bno;  
end if  
commit;  
end  
  
【问题2】  
f： after  
g： all\_nums  
h: for each row  
i: NEW.all\_nums  
j: OLD.all\_nums  
k: bookorders  
  
【问题3】  
说明T4时刻，用户2事务读取到的all\_nums数值是498。  
在T8时刻，all\_nums数据会出现不一致性的问题，由于用户2事务读到了用户1修改过的all\_nums,然后在T7时刻用户1事务回滚了之前对all\_nums的修改，把all\_nums恢复到了500。最终用户2事务读到的数据是498，读到的是脏数据。所以是属于读脏数据的不一致。  
  
![38c7a8dae8b842be83790f3b92b553af.jpg][]  


## 第5题 ##

【问题1】  
I,J,K的数值会恢复为I=3,J=5,K=9  
  
【问题2】  
Redo:T2  
Undo:T3  
  
【问题3】  
由于掉电造成磁盘介质损坏，数据库已经无法启动，恢复过程的步骤如下所示：（1）装入最新的数据库后备副本，使数据库恢复到最近一次转储时的一致性状态。（2）转入相应的日志文件副本，重做已完成的事务。因为在checkpoint这个日志点之前，T1已经完成，T2在检查点之后完成的，T3还没有完成，所以，T2需要重做，T3需要回滚。由于掉电造成磁盘介质损坏，数据库已经无法启动，恢复过程的步骤如下所示：（1）装入最新的数据库后备副本，使数据库恢复到最近一次转储时的一致性状态。（2）转入相应的日志文件副本，重做已完成的事务。  



[9911b3d09e02423c97927542d8dfad43.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第1题/9911b3d09e02423c97927542d8dfad43.jpg
[959b1653c1c141fbb9cd13fbef4e19ea.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第1题/959b1653c1c141fbb9cd13fbef4e19ea.jpg
[38c7a8dae8b842be83790f3b92b553af.jpg]: https://www.xkxxkx.cn/file/exam/software/数据库系统工程师/案例/第4题/38c7a8dae8b842be83790f3b92b553af.jpg
