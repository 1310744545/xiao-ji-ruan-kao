---  
title: 2018年上半年  
# icon: gears  
order: 998  
category:  
- 历年真题  
tag:  
- 真题  
  
# navbar: false  
# sidebar: false  
  
# breadcrumb: false  
# pageInfo: false  
# contributors: false  
# editLink: false  
# lastUpdated: false  
# prev: false  
# next: false  
comment: false  
# footer: false  
  
# backtotop: false  
---  
## 第1题 ##

试题一（15分）  
阅读下列说明，回答问题1至问题4，将解答填入答题纸的对应栏内。  
【说明】  
恶意代码是指为达到恶意目的专门设计的程序或者代码。常见的恶意代码类型有特洛伊木马、蠕虫、病毒、后门、Rootkit、僵尸程序、广告软件。  
2017年5月,勒索软件WanaCry席卷全球,国内大量高校及企事业单位的计算机被攻击,文件及数据被加密后无法使用,系统或服务无法正常运行,损失巨大。  
  
【问题1】（2分）  
按照恶意代码的分类,此次爆发的恶意软件属于哪种类型?  
  
【问题2】（2分）  
此次勒索软件针对的攻击目标是Windows还是Linux类系统?  
  
【问题3】（6分）  
恶意代码具有的共同特征是什么?  
  
【问题4】（5分）  
由于此次勒索软件需要利用系统的SMB服务漏洞(端口号445)进行传播,我们可以配置防火墙过滤规则来阻止勒索软件的攻击,请填写表1-1中的空（1）-（5）,使该过滤规则完整。  
注:假设本机IP地址为:1.2.3.4,”\*”表示通配符。  
![d31d0220b193420fb0d925b405fe75d2.jpg][]  


## 第2题 ##

试题二（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
密码学的基本目标是在有攻击者存在的环境下,保证通信双方(A和B)之间能够使用不安全的通信信道实现安全通信。密码技术能够实现信息的保密性、完整性、可用性和不可否认性等安全目标。一种实用的保密通信模型往往涉及对称加密、公钥密码、Hash函数、数字签名等多种密码技术。  
在以下描述中,M表示消息,H表示Hash函数,E表示加密算法,D表示解密算法,K表示密钥,SKA表示A的私钥,PKA表示A的公钥,SKB表示B的私钥,PKB表示B的公钥,||表示连接操作。  
  
【问题1】（6分）  
用户AB双方采用的保密通信的基本过程如图2-1所示。  
![9ece4b6840f94e0c96a31c850203e526.jpg][]  
请问图2-1所设计的保密通信模型能实现信息的哪些安全目标?图2-1中的用户A侧的H和E能否互换计算顺序?如果不能互换请说明原因:如果能互换请说明对安全目标的影响。  
  
【问题2】（4分）  
图2-2给出了另一种保密通信的基本过程：  
![5bfb176d32fd4bbab66f70e16ec0d50a.jpg][]  
请问图2-2设计的保密通信模型能实现信息安全的哪些特性?  
  
【问题3】（5分）  
为了在传输过程中能够保障信息的保密性、完整性和不可否认性,设计了一个安全通信模型结构如图2-3所示：  
![07a80beb11c543d3a6527182c5ff7f1f.jpg][]  
请问图2-3中（1），（2）分别应该填什么内容?  


## 第3题 ##

试题三（15分）  
阅读下列说明，回答问题1至问题3，将解答填入答题纸的对应栏内。  
【说明】  
在Linux系统中,用户账号是用户的身份标志,它由用户名和用户口令组成。  
  
【问题1】（4分）  
Linux系统将用户名和口令分别保存在哪些文件中?  
  
【问题2】（7分）  
Linux系统的用户名文件通常包含如下形式的内容:  
root:x:0:0:root:root:/bin/bash  
bin:x:1:1:bin:/bin:/sbin/nologin  
hujw:x:500:500:hujianwei:/home/hujw:/bin/bash  
文件中的一行记录对应着一个用户,每行记录用冒号(:)分隔为7个字段,请问第1个冒号(第二列)和第二个冒号(第三列)的含义是什么?  
上述用户名文件中,第三列的数字分别代表什么含义?  
  
【问题3】（4分）  
Linux系统中用户名文件和口令字文件的默认访问权限分别是什么?  


## 第4题 ##

试题四（15分）  
阅读下列说明和C语言代码，回答问题1至问题4，将解答写在答题纸的对应栏内。  
【说明】  
在客户服务器通信模型中,客户端需要每隔一定时间向服务器发送数据包,以确定服务器是否掉线,服务器也能以此判断客户端是否存活,这种每隔固定时间发一次的数据包也称为心跳包。心跳包的内容没有什么特别的规定,一般都是很小的包。  
某系统采用的请求和应答两种类型的心跳包格式如图4-1所示。  
![282e74a8111b4cc7b123a9e7a9ae38e1.jpg][]  
心跳包类型占1个字节，主要是请求和响应两种类型；  
心跳包数据长度字段占2个字节，表示后续数据或者负载的长度。  
接收端收到该心跳包后的处理函数是process\_heartbeat(),其中参数p指向心跳包的报文数据,s是对应客户端的socket网络通信套接字。  
void process\_heartbeat(unsigned char \*p, SOCKET s)  
\{  
unsigned short hbtype;  
unsigned int payload;  
hbtype=\*p++; //心跳包类型  
n2s(p, payload); //心跳包数据长度  
pl=p; //pl指向心跳包数据  
if（hbtype=HB\_REQUEST）\{  
unsigned char \*buffer, \*bp;  
buffer=malloc(1+2+payload);  
\*bp++=HB\_RESPONSE; //填充1 byte的心跳包类型  
s2n(payload, bp); //填充2 bytes的数据长度  
memcpy(bp,pl,payload);  
/\*将构造好的心跳响应包通过socket s返回客户端 \*/  
r=write\_bytes(s, buffer,3+payload);  
\}  
\}  
  
【问题1】（4分）  
（1）心跳包数据长度字段的最大取值是多少?  
（2）心跳包中的数据长度字段给出的长度值是否必须和后续的数据字段的实际长度一致？  
  
【问题2】（5分）  
（1）上述接收代码存在什么样的安全漏洞?  
（2）该漏洞的危害是什么?  
  
【问题3】（2分）  
模糊测试(Fuzzing)是一种非常重要的信息系统安全测评方法,它是一种基于缺陷注入的自动化测试技术。请问模糊测试属于黑盒测试还是白盒测试?其测试结果是否存在误报?  
  
【问题4】（4分）  
模糊测试技术能否测试出上述代码存在的安全漏洞?为什么?  


## 第5题 ##

试题五（15分）  
阅读下列说明和图，回答问题1至问题5，将解答填入答题纸的对应栏内。  
【说明】  
入侵检测系统(IDS)和入侵防护系统(IPS)是两种重要的网络安全防御手段,IDS注重的是网络安全状况的监管,IPS则注重对入侵行为的控制。  
  
【问题1】（2分）  
网络安全防护可以分为主动防护和被动防护,请问IDS和IPS分别属于哪种防护?  
  
【问题2】（4分）  
入侵检测是动态安全模型(P2DR)的重要组成部分。请列举P2DR模型的4个主要组成部分。  
  
【问题3】（2分）  
假如某入侵检测系统记录了如图5-1所示的网络数据包：  
![10a6c7373d41465e804a53fded2d1777.jpg][]  
请问图中的数据包属于哪种网络攻击?该攻击的具体名字是什么?  
  
【问题4】（4分）  
入侵检测系统常用的两种检测技术是异常检测和误用检测,请问针对图中所描述的网络攻击应该采用哪种检测技术?请简要说明原因。  
  
【问题5】（3分）  
Snort是一款开源的网络入侵检测系统,它能够执行实时流量分析和IP协议网络的数据包记录.  
Snort的配置有3种模式,请给出这3种模式的名字。  
  


## 答案及解析 ##

  



[d31d0220b193420fb0d925b405fe75d2.jpg]: https://www.xkxxkx.cn/file/exam/software/信息安全工程师/案例/第1题/d31d0220b193420fb0d925b405fe75d2.jpg
[9ece4b6840f94e0c96a31c850203e526.jpg]: https://www.xkxxkx.cn/file/exam/software/信息安全工程师/案例/第2题/9ece4b6840f94e0c96a31c850203e526.jpg
[5bfb176d32fd4bbab66f70e16ec0d50a.jpg]: https://www.xkxxkx.cn/file/exam/software/信息安全工程师/案例/第2题/5bfb176d32fd4bbab66f70e16ec0d50a.jpg
[07a80beb11c543d3a6527182c5ff7f1f.jpg]: https://www.xkxxkx.cn/file/exam/software/信息安全工程师/案例/第2题/07a80beb11c543d3a6527182c5ff7f1f.jpg
[282e74a8111b4cc7b123a9e7a9ae38e1.jpg]: https://www.xkxxkx.cn/file/exam/software/信息安全工程师/案例/第4题/282e74a8111b4cc7b123a9e7a9ae38e1.jpg
[10a6c7373d41465e804a53fded2d1777.jpg]: https://www.xkxxkx.cn/file/exam/software/信息安全工程师/案例/第5题/10a6c7373d41465e804a53fded2d1777.jpg
## 第1题 ##

【问题1】  
蠕虫类型  
  
本题综合了恶意代码的基本知识以及如何同防火墙联动阻止恶意代码的攻击行为，考查考生对恶意代码基本概念的理解程度以及防火墙过滤规则的设置能力。  
病毒、蠕虫和特洛伊木马是可导致用户计算机和计算机上的信息损坏的恶意程序。病毒的明确定义是“编制或者在计算机程序中插入的破坏计算机功能或者破坏数据，影响计算机使用并且能够自我复制的组计算机指令或者程序代码”。病毒必须满足两个条件。  
1.它必须能自行执行。它通常将自己的代码置于另一个程序的执行路径中。  
2.它必须能自我复制。例如，它可能用受病毒感染的文件副本替换其他可执行文件。病毒既可以感染桌面计算机也可以感染网络服务器。  
蠕虫是一种通过网络传播的恶性病毒，它具有病毒的一些共性，如传播性、隐蔽性、破坏性等等，同时具有自己的一些特征，如不利用文件寄生（有的只存在于内存中），对网络造成拒绝服务，以及和黑客技术相结合，等等。  
木马是指那些表面上是有用的软件、实际目的却是危害计算机安全并导致严重破坏的计算机程序。它是具有欺骗性的文件(宣称是良性的，但事实上是恶意的），是一种基于远程控制的黑客工具，具有隐蔽性和非授权性的特点。  
此次勒索软件是通过系统漏洞实现网络的自动传播，并完成其各种恶意功能。  
  
【问题2】  
Windows操作系统  
  
该勒索软件利用的Windows系统的安全漏洞，因此其攻目标标也是Windows类系统。  
  
【问题3】  
恶意代码具有如下共同特征：（1） 恶意的目的（2） 本身是计算机程序（3） 通过执行发生作用。  
  
总地来说，恶意代码首先就是具有恶意目的,不管是造成网络瘫痪还是窃取个人隐私目的是恶意的；其次这些恶意代码通常都是完整的计算机程序，可以实现自我传播或者感染其他程序；最后恶意代码需要被执行才能发挥其恶意的功能，恶意代码如果没行执行的可能，就无法达到其恶意目的。  
  
【问题4】  
（1） \*.\*.\*.\* （2） \*（3）445 （4）TCP （5）\*  
  
针对该勒索软件的攻击和传播特点，需要对SMB服务所在的445端口进行过滤，只要网外对网内445端口的所有连接请求予以过滤。需要注意的是SMB服务是基于TCP协议的。  


## 第2题 ##

【问题1】  
完整性；可以互换；不影响完整性安全目标。  
  
本题主要考查保密通信所涉及的关键技术，信息安全所涉及哈希、加解密、安全通信等之间的关系以及在实际安全通信中的应用。  
在保密通信模型一当中，首先消息M是没有加密的，关键是对消息M计算哈希值然后对哈希进行了加密，因此重点实现的是对消息M的完整性同标。由此可知，先计算哈希值还是先对M加密后再计算哈希值，都不会影响该安全目标。  
  
【问题2】  
保密性和完整性。  
  
模型二相对模型一的最大区别就是，消息M被加密了，因此在模型一的基础上，增加了保密性的目标。  
  
【问题3】  
![88e8075fe64b439bb6c360f7232d260d.jpg][]  
  
本题目综合考查各种安全目标的实现技术。在此模型下，增加了不可否认的目标实现。此时需要发送者用私钥签名，接收端用公钥验证签名。对于空（1），要求考生清楚整个签名过程的细节和各个要素的作用，而空（2）只要用对应的公钥去解密哈希值即可。  


## 第3题 ##

【问题1】  
/etc/passwd  
/etc/shadow  
  
本题考查Linux系统安全相关问题，主要是对Linux系统中用户和口令的安全管理以及文件的访问权限等知识点进行考察。  
Linux系统中用户和口令是分开保存的。用户名信息主要保存在/etc/passwd文件中，而口令信息这是通过哈希加盐处理后保存在/etc/shadow的影子文件中。  
  
【问题2】  
用户名:口令：  
用户标识号:组标识号:注释性描述:主目录:登录Shell。  
超级用户(0)，系统管理账号(1-99),普通账号(500)。  
  
题目给出的是/etc/passwd文件中的部分内容，每一行代表一个用户及其信息，每行格式及用冒号分隔的字段含义是：  
用户名:口令：用户标识号:组标识号:注释性描述:主目录：登录Shell。  
其中口令都是用x表示，单独在口令字文件中保存。第三列表示的用户的组别信息。  
  
【问题3】  
数字形式:744 (2 分),400 (600)  
或  
文字形式：用户名文件全局可读（2分），口令字文件只有超级用户可读（写）  
  
通常情况下，用户名文件是系统中所有用户可读的，但只有root有修改权限。采用标准的Linux系统访问控制来描述就是rwxr--r--，用数字表示就是744。而口令字文件只有root用户有权读写，其他用户是没有任何权限的，因此其访问权限模式是：400或者600。  


## 第4题 ##

【问题1】  
（1）心跳包数据长度的最大取值为65535。  
（2）不是一致的。  
  
本题是综合考查考生对网络协议分析、代码安全审计以及代码安全测试技术掌握程度的题目。  
根据协议字段说明，心跳包数据长度字段为2个字节，就是16位，因此其最大值为216\-1=65535。  
通过题目给出的代码分析可知，代码是直接从数据包中提取长度字段的，而且没有对数据包的实际长度进行计算，因此实际长度和数据包中给出的长度并不要求一致，这也是该代码漏洞的根本原因。  
  
【问题2】  
存在溢出安全漏洞。  
接收端处理代码在组装响应包时，心跳包数据长度字段（payload)采用的是客户端发送的请求包中使用的长度字段，由于心跳包数据长度字段完全由客户端控制，当payload大于实际心跳包数据的长度时，将导致越界访问接收端内存，从而泄露内存信息。（2分）  
造成的危害：在正常的情况下，response报文中的data就是request报文中的data 数据，但是在异常情况下，payload的长度远大于实际数据的长度，这样就会发生内存的越界访问，但这种越界访问并不会直接导致程序异常，（因为这里直接memcpy后，服务器端并没有使用copy后的数据，而只是简单的进行了回复报文的填充，如果服务端使用了copy的数据也许就可能发现问题）这里使用了memcpy函数，该函数会直接根据长度把内存中数据复制给另一个变量。这样就给恶意的程序留下了后门，当恶意程序给data 的长度变量赋值为65535时，就可以把内存中64KB的内存数据通过Response报文发送给客户端，这样客户端程序就可以获取到一些敏感数据泄露。  
  
【问题3】  
属于黑盒测试；不存在误报。  
  
模糊测试不需要源代码，是一种黑盒测试技术。通过往被测试程序发送或者注入各种数据，如果被测试程序出现异常，说明程序确实是存在问题的，不会有误报。  
  
【问题4】  
不能。  
因为不会产生异常，模糊测试器就无法监视到异常，从而无法检测到该漏洞。  
  
上述代码存在的信息泄露漏洞在模糊测试过程中，不管用什么样的数据包长度去测试，被测代码都是正常运行，没有出现异常情况，因此也就无法判断是否有漏洞，所以模糊测试无法测试出该代码存在的漏洞。  


## 第5题 ##

【问题1】  
IDS：被动防护，IPS主动防护。  
  
本题综合考查考生的网络协议分析、基本的网络扫描技术、入侵检测技术的掌握和运用能力。  
入侵检测系统（IDS)大都是通过攻击的签名来实现攻击检测，属于被动防护，而IPS可以根据预先设定的安全策略，对流经的每个报文进行深度检测（协议分析追踪、特征匹配、流量统计分析、事件关联分析等）发现隐藏于网络中的攻击，属于主动防护。  
安全策略(Policy),安全防护(Protection),检测(Detection),响应(Response)。  
  
【问题2】  
P2DR是一种动态网络安全模型，P2DR模型由四个主要部分组成：安全策略 (Policy)、保护（Protection)、检测（Detection)和响应（Response)。PPDR模型是在整体的安全策略的控制和指导下，综合运用防护工具（如防火墙、身份认证、加密等）的同时，利用检测工具（如漏洞评估、入侵检测系统）了解和评估系统的安全状态，通过适当的响应将系统调整到一个比较安全的状态。保护、检测和响应组成了一个完整的、动态的安全循环。  
  
【问题3】  
拒绝服务攻击，SYN flooding (洪泛）。  
  
从图5-1中可以看出，数据包都是SYN请求建立分组，源IP地址都是随机的，是典型SYN泛洪攻击，其目的就是消耗网络资源，实现拒绝服务。  
  
【问题4】  
误用检测；该攻击有很明确的攻击特征和模式，适合采用误用检测。  
  
异常检测是指根据非正常行为（系统或用户）和使用计算机非正常资源来检测入侵行为。其关键在于建立用户及系统正常行为轮廓（Profile),检测实际活动以判断是否背离正常轮廓。  
误用检测又称为基于特征的检测，基于误用的入侵检测系统通过使用某种模式或者信号标示表示攻击，进而发现同类型的攻击。  
显然针对上述攻击，根据SYN分组特征模式，应该采用误用检测来检测攻击。  
嗅探，包记录，网络入侵检测。  
  
【问题5】  
Snort有三种工作方式，分别是嗅探器、数据包记录器和网络入侵检测系统。  
1.嗅探（Snort从网络上读出数据包并将其显示在控制台上)  
2.数据包记录器（将数据包记录在硬盘上）  
3.网络入侵检测系统NIDS (最复杂，可配置，允许Snort匹配用户自定义的数据集，并根据检测结果执行一定的动作）  



[88e8075fe64b439bb6c360f7232d260d.jpg]: https://www.xkxxkx.cn/file/exam/software/信息安全工程师/案例/第2题/88e8075fe64b439bb6c360f7232d260d.jpg
